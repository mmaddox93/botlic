const a6_0x498a=['toDataURL','sharp','CLIENT_ID','ip_list','node-fetch','expires','You\x20cannot\x20edit\x20your\x20own\x20permission\x20level','Given\x20product\x20already\x20exists','cookie','Invalid\x20IP-Cap!','filename','hwid','successful_requests','4903599hQDfYE','Email\x20or\x20password\x20is\x20wrong.','17CpYYEi','product','76xPAlMW','unknown\x20user','select','requests','cache','Login','Please\x20login\x20now!','clearCookie','country','../models/blacklistModel','data','1425589iJRQIW','Successfully\x20deleted\x20blacklisted\x20IP/HWID','Successfully\x20reset\x20private\x20API\x20key','prev','qrcode','Successfully\x20updated\x20profile\x20picture!','Invalid\x20type','SecretKey','findOneAndUpdate','clientname','Token\x20is\x20incorrect','license','602590EkBBRf','rejected_requests','save','hwid_list','You\x20dont\x20have\x20enough\x20permissions','webhook_image','Img\x20upload','That\x20IP/HWID\x20already\x20exists','findByIdAndUpdate','BASE_URL','resize','push','User\x20created','Passwords\x20does\x20not\x20match','true','../utils/fileStorage','file','twofactor_secret','current_id','response','validate','save_requests','Update\x20progress\x20chart','Successfully\x20updated\x20user','created_by','https://discord.com/api/oauth2/token','findById','env','query','hash','1526284kPUucL','Product\x20updated','catch','image','7days','reduce','../models/productsModel','cookies','twofactor','totp','setDate','role','Invalid\x20IP-Expires!','IP-Cap\x20cannot\x20be\x20lower\x20that\x20current\x20amount\x20of\x20IPs','false','Password\x20successfully\x20changed!','moment','next','private_key','Product\x20created','REFRESH_TOKEN_SECRET','Successfully\x20cleared\x20HWIDs','then','Delete\x20success','../models/licenseModel','../models/logsModel','Successfully\x20reset\x20license\x20key','You\x20need\x20to\x20select\x20a\x20valid\x20date\x20from\x20future!','../models/dashboardModel','23983lkogPS','login','setHours','collation','page','Success','../models/userModel','User\x20deleted','Bot\x20','test','You\x20dont\x20have\x20webhook\x20image','getHours','Public\x20key\x20reset','Discord\x20linked','Successfully\x20cleared\x20IPss','replace','includes','verify','../utils/userValidations','Blacklist\x20created','parse','Invalid\x20discount\x20percentage','activity','none','identify','base32','1ZPmBUD','Product\x20is\x20in\x20use!\x20Delete\x20licenses\x20which\x20are\x20bind\x20to\x20this\x20product\x20first!','findByIdAndDelete','jsonwebtoken','axios','access_token','fill','licensekey','Password\x20changed','Progress\x20goal\x20updated\x20successfully!','crypto','total_purchases','discord.js','limit','Invalid\x20HWID-Expires!','toLocaleDateString','json','get','error','date','Successfully\x20added\x20a\x20new\x20blacklist','Invalid\x20price','https://proxycheck.io/v2/','hex','1Wyhbat','7666rixUIz','/api/users/discord/oauth','unlinkSync','2FA\x20already\x20enabled','toFixed','Name\x20must\x20be\x20at\x20least\x203\x20characters\x20long','../models/requestsModel','sort','findOne','Something\x20weird\x20happened','setActivity','updateMany','editing','https://i.imgur.com/A3OVRtG.png','Successfully\x20deleted\x20user','New\x20password\x20cannot\x20be\x20same\x20as\x20old.','5qjHdDW','DiscordID\x20did\x20not\x20match\x20any\x20existing\x20user','expiring','User\x20with\x20that\x20email\x20already\x20exists','email','createdAt','Discord\x20ID\x20is\x20not\x20valid','Weird\x20shit,\x20contact\x20kassq\x20#2','Goal\x20must\x20be\x20over\x201!','../utils/last7days','License\x20deleted','toLowerCase','message','License\x20IPs\x20cleared','slice','updateOne','Version\x20number\x20must\x20be\x20at\x20least\x203\x20characters\x20long!','GUILDS','password','Invalid\x20webhook\x20colors','../utils/generateLicense','reverse','results','None','path','Permission\x20denied','sign','DISCORD_BOT_TOKEN','You\x20cannot\x20edit\x20root\x20user\x20permission\x20level','Product\x20name\x20must\x20be\x20at\x20least\x203\x20characters\x20long','Weird\x20shit,\x20contact\x20kassq\x20#1','username','body','log','/api/users/refresh_token','progressGoal','refreshtoken','Successfully\x20updated','public_key','findOneAndDelete','Login\x20success!','Bearer\x20','You\x20already\x20have\x20product\x20called\x20','Invalid\x20HWID-Cap!','length','Description\x20too\x20long!','20157FaDIsc','License\x20key\x20already\x20exists','save_discord','30days','Product\x20not\x20found','00000','Logout','Successfully\x20deleted\x20license\x20key','Password\x20is\x20not\x20correct.','payment_sum','continent','toFile','find','getDate','status','exports','speakeasy','Invalid\x20IP-address','Password\x20is\x20required','-twofactor\x20-password\x20-twofactor_secret\x20-createdAt\x20-updatedAt','toBuffer','price','user','months','format','License\x20does\x20not\x20exist','Days\x20must\x20be\x20greated\x20than\x200!','application/x-www-form-urlencoded','name','existsSync','../build/images/','details','Product\x20deleted','join','CLIENT_SECRET','ACCESS_TOKEN_SECRET','_id'];const a6_0x346cc9=a6_0x5d1e;(function(_0x322a88,_0x359951){const _0x449845=a6_0x5d1e;while(!![]){try{const _0x406828=-parseInt(_0x449845(0x111))+parseInt(_0x449845(0xd0))*-parseInt(_0x449845(0x106))+-parseInt(_0x449845(0x172))*parseInt(_0x449845(0x13b))+-parseInt(_0x449845(0x18a))*-parseInt(_0x449845(0x11d))+-parseInt(_0x449845(0xa2))*parseInt(_0x449845(0x158))+-parseInt(_0x449845(0x104))*parseInt(_0x449845(0x18b))+parseInt(_0x449845(0x102));if(_0x406828===_0x359951)break;else _0x322a88['push'](_0x322a88['shift']());}catch(_0x33a94a){_0x322a88['push'](_0x322a88['shift']());}}}(a6_0x498a,0xbc833));const argon=require('argon2'),jwt=require(a6_0x346cc9(0x175)),path=require(a6_0x346cc9(0xba)),fetch=require(a6_0x346cc9(0xf9)),fs=require('fs'),axios=require(a6_0x346cc9(0x176)),moment=require(a6_0x346cc9(0x14b)),crypto=require(a6_0x346cc9(0x17c)),{Client,Intents}=require(a6_0x346cc9(0x17e)),sharp=require(a6_0x346cc9(0xf6));function a6_0x5d1e(_0x48ade4,_0x4d4c55){return a6_0x5d1e=function(_0x498a05,_0x5d1e57){_0x498a05=_0x498a05-0xa2;let _0x19846c=a6_0x498a[_0x498a05];return _0x19846c;},a6_0x5d1e(_0x48ade4,_0x4d4c55);}sharp[a6_0x346cc9(0x10a)](![]);const speakeasy=require(a6_0x346cc9(0xe0)),QRCode=require(a6_0x346cc9(0x115)),updateBotPermissions=require('../utils/updateBotPermissions'),Users=require(a6_0x346cc9(0x15e)),Dashboard=require(a6_0x346cc9(0x157)),Licenses=require(a6_0x346cc9(0x153)),Products=require(a6_0x346cc9(0x141)),Requests=require(a6_0x346cc9(0x191)),Logs=require(a6_0x346cc9(0x154)),Blacklist=require(a6_0x346cc9(0x10f)),{loginSchema,passwordValidate,createlicenseValidate,emailValidate}=require(a6_0x346cc9(0x16a)),{decrypt,encrypt}=require('../utils/crypto'),{upload}=require(a6_0x346cc9(0x12c)),{generateProductKey}=require(a6_0x346cc9(0xb6)),{LastNDays,LastNDates}=require(a6_0x346cc9(0xab)),{logger}=require('../utils/logger'),userCtrl={'login':async(_0x428e7b,_0x433637)=>{const _0x1ca7f7=a6_0x346cc9;try{const {email:_0x465061,password:_0x7e4f24,twofactor:_0x5c0e93}=_0x428e7b[_0x1ca7f7(0xc2)],_0x373f0f=loginSchema['validate']({'email':_0x465061,'password':_0x7e4f24});if(_0x373f0f[_0x1ca7f7(0x184)])return console[_0x1ca7f7(0xc3)](_0x373f0f[_0x1ca7f7(0x184)]),_0x433637[_0x1ca7f7(0xde)](0x1a6)[_0x1ca7f7(0x182)]({'msg':_0x373f0f['error'][_0x1ca7f7(0xef)][0x0][_0x1ca7f7(0xae)]});const _0x182ba1=await Users[_0x1ca7f7(0x193)]({'email':_0x465061});if(!_0x182ba1)return _0x433637['status'](0x190)[_0x1ca7f7(0x182)]({'msg':_0x1ca7f7(0x103)});const _0x12084d=await argon[_0x1ca7f7(0x169)](_0x182ba1[_0x1ca7f7(0xb4)],_0x7e4f24);if(!_0x12084d)return _0x433637[_0x1ca7f7(0xde)](0x190)[_0x1ca7f7(0x182)]({'msg':_0x1ca7f7(0x103)});if(_0x182ba1[_0x1ca7f7(0x143)]&&_0x5c0e93==='')return _0x433637[_0x1ca7f7(0xde)](0x191)[_0x1ca7f7(0x182)]();if(_0x182ba1[_0x1ca7f7(0x143)]&&_0x5c0e93){const _0x33ad3c=speakeasy[_0x1ca7f7(0x144)][_0x1ca7f7(0x169)]({'secret':_0x182ba1['twofactor_secret'],'encoding':_0x1ca7f7(0x171),'token':_0x5c0e93,'window':0x1});if(!_0x33ad3c)return _0x433637['status'](0x190)[_0x1ca7f7(0x182)]({'msg':'2FA\x20code\x20not\x20correct.'});}const _0x3ba67e=createRefreshToken({'id':_0x182ba1[_0x1ca7f7(0xf4)]});return _0x433637[_0x1ca7f7(0xfd)](_0x1ca7f7(0xc6),_0x3ba67e,{'httpOnly':!![],'path':_0x1ca7f7(0xc4),'expiresIn':0xa4cb800}),await Users[_0x1ca7f7(0xb1)]({'_id':_0x182ba1['_id']},{'$set':{'lastlogin':new Date()}}),logger(_0x1ca7f7(0x10b),_0x182ba1[_0x1ca7f7(0xec)],0x0),_0x433637['json']({'msg':_0x1ca7f7(0xca)});}catch(_0x2a235f){return console[_0x1ca7f7(0xc3)](_0x2a235f),_0x433637[_0x1ca7f7(0xde)](0x1f4)['json']({'msg':_0x2a235f[_0x1ca7f7(0xae)]});}},'logout':async(_0x5a59e2,_0xfddd45)=>{const _0x5df589=a6_0x346cc9;try{return _0xfddd45[_0x5df589(0x10d)](_0x5df589(0xc6),{'path':_0x5df589(0xc4)}),logger(_0x5df589(0xd6),null,0x0),_0xfddd45['json']({'msg':'Logged\x20out.'});}catch(_0x57cee7){return console[_0x5df589(0xc3)](_0x57cee7),_0xfddd45[_0x5df589(0xde)](0x1f4)[_0x5df589(0x182)]({'msg':_0x57cee7[_0x5df589(0xae)]});}},'getAccessToken':(_0x5643f9,_0x108aec)=>{const _0x4ecbce=a6_0x346cc9;try{const _0x1190e7=_0x5643f9[_0x4ecbce(0x142)][_0x4ecbce(0xc6)];if(!_0x1190e7)return _0x108aec['status'](0x190)[_0x4ecbce(0x182)]({'msg':'Please\x20login\x20now!'});jwt[_0x4ecbce(0x169)](_0x1190e7,process['env'][_0x4ecbce(0x14f)],(_0x4a7030,_0x148239)=>{const _0x158448=_0x4ecbce;if(_0x4a7030)return _0x108aec[_0x158448(0xde)](0x190)['json']({'msg':_0x158448(0x10c)});const _0x5062c5=createAccessToken({'id':_0x148239['id']});_0x108aec[_0x158448(0x182)]({'access_token':_0x5062c5});});}catch(_0xf21e40){return console['log'](_0xf21e40),_0x108aec[_0x4ecbce(0xde)](0x1f4)[_0x4ecbce(0x182)]({'msg':_0xf21e40[_0x4ecbce(0xae)]});}},'getUserInfor':async(_0x7e60a,_0x5c4d21)=>{const _0x255333=a6_0x346cc9;try{const _0x4eefd2=await Users['findById'](_0x7e60a[_0x255333(0xe6)]['id'])[_0x255333(0x108)]('-password\x20-licenses');_0x5c4d21[_0x255333(0x182)](_0x4eefd2);}catch(_0x330aea){return console[_0x255333(0xc3)](_0x330aea),_0x5c4d21[_0x255333(0xde)](0x1f4)[_0x255333(0x182)]({'msg':_0x330aea['message']});}},'uploadImage':async(_0x3d26d4,_0x401d9b)=>{const _0x5823d8=a6_0x346cc9,_0x40f6da=_0x3d26d4[_0x5823d8(0xe6)]['id'];upload(_0x3d26d4,_0x401d9b,async _0x5aebae=>{const _0x13d6f4=_0x5823d8;if(_0x5aebae)return console[_0x13d6f4(0xc3)](_0x5aebae),_0x401d9b[_0x13d6f4(0xde)](0x1f4)['json']({'msg':_0x5aebae[_0x13d6f4(0xae)]});const _0xea929=_0x3d26d4['file'][_0x13d6f4(0xba)],_0x2a6977=await sharp(_0xea929)['resize'](0xc8,0xc8)[_0x13d6f4(0xe4)]();await sharp(_0x2a6977)[_0x13d6f4(0xdb)](_0xea929);const _0x1c8005=await Users[_0x13d6f4(0x137)]({'_id':_0x40f6da});if(_0x1c8005[_0x13d6f4(0x13e)]){const _0x178b44=path[_0x13d6f4(0xf1)](__dirname,_0x13d6f4(0xee)+_0x1c8005[_0x13d6f4(0x13e)]);fs['existsSync'](_0x178b44)&&fs[_0x13d6f4(0x18d)](_0x178b44);}return logger('Img\x20upload',_0x1c8005[_0x13d6f4(0xec)],0x0),await Users[_0x13d6f4(0x119)]({'_id':_0x40f6da},{'$set':{'image':_0x3d26d4[_0x13d6f4(0x12d)][_0x13d6f4(0xff)]}}),_0x401d9b[_0x13d6f4(0x182)]({'msg':_0x13d6f4(0x116)});});},'generate2FA':async(_0x16d040,_0x251d84)=>{const _0x2d485e=a6_0x346cc9;try{const _0x1ba037=await Users[_0x2d485e(0x137)]({'_id':_0x16d040[_0x2d485e(0xe6)]['id']});if(_0x1ba037[_0x2d485e(0x143)])return _0x251d84[_0x2d485e(0xde)](0x1f4)[_0x2d485e(0x182)]({'msg':_0x2d485e(0x18e)});const _0x147a0b=speakeasy['generateSecret']();await Users['findByIdAndUpdate']({'_id':_0x16d040['user']['id']},{'$set':{'tempsecret':_0x147a0b[_0x2d485e(0x171)]}});const _0x20c317=_0x147a0b['otpauth_url'][_0x2d485e(0x167)](_0x2d485e(0x118),'uLicense:'+_0x1ba037['email']);QRCode[_0x2d485e(0xf5)](_0x20c317,(_0x309792,_0x4ce7a5)=>{const _0x53cd9e=_0x2d485e;_0x251d84[_0x53cd9e(0x182)](_0x4ce7a5);}),logger('2FA\x20generate',_0x1ba037[_0x2d485e(0xec)],0x0);}catch(_0x474c1c){return console[_0x2d485e(0xc3)](_0x474c1c);}},'verify2FA':async(_0x4bc5c2,_0x46b591)=>{const _0x306aea=a6_0x346cc9,{usertoken:_0x45c507}=_0x4bc5c2[_0x306aea(0xc2)];if(!_0x45c507)return;try{const _0x5e7813=await Users[_0x306aea(0x137)](_0x4bc5c2[_0x306aea(0xe6)]['id']),_0x2a9b23=speakeasy[_0x306aea(0x144)]['verify']({'secret':_0x5e7813['tempsecret'],'encoding':_0x306aea(0x171),'token':_0x45c507});if(_0x2a9b23)await Users['findByIdAndUpdate']({'_id':_0x4bc5c2[_0x306aea(0xe6)]['id']},{'$rename':{'tempsecret':_0x306aea(0x12e)},'$set':{'twofactor':!![]}}),logger('2FA\x20enabled',_0x5e7813[_0x306aea(0xec)],0x0),_0x46b591['json'](_0x306aea(0x15d));else return _0x46b591['status'](0x1f4)['json']({'msg':_0x306aea(0x11b)});}catch(_0x2b00f8){return console[_0x306aea(0xc3)](_0x2b00f8);}},'remove2FA':async(_0x31f899,_0x5087f6)=>{const _0x5786d3=a6_0x346cc9,{password:_0x3062a7}=_0x31f899[_0x5786d3(0xc2)];if(!_0x3062a7)return;try{const _0x3407c7=await Users['findById']({'_id':_0x31f899[_0x5786d3(0xe6)]['id']}),_0x32855b=await argon[_0x5786d3(0x169)](_0x3407c7[_0x5786d3(0xb4)],_0x3062a7);if(!_0x32855b)return _0x5087f6['status'](0x190)['json']({'msg':'Password\x20is\x20not\x20correct.'});await Users['findOneAndUpdate']({'_id':_0x31f899[_0x5786d3(0xe6)]['id']},{'$set':{'twofactor':![]},'$unset':{'twofactor_secret':''}}),logger('2FA\x20removed',_0x3407c7[_0x5786d3(0xec)],0x0),_0x5087f6[_0x5786d3(0x182)]('Successfully\x20disabled\x202FA');}catch(_0x1684ae){console['log'](_0x1684ae);}},'getDiscordAuth':async(_0x1ae704,_0x437ea0)=>{const _0x277827=a6_0x346cc9;try{_0x437ea0[_0x277827(0x182)]({'client_id':process['env'][_0x277827(0xf7)],'callback_url':process['env'][_0x277827(0x126)]+_0x277827(0x18c)});}catch(_0x2366dc){return console[_0x277827(0xc3)](_0x2366dc);}},'verifyDiscordAuth':async(_0x1a834e,_0x4b5be4)=>{const _0x4704ee=a6_0x346cc9;try{const {code:_0x365ead}=_0x1a834e['body'],_0x109dcb=_0x1a834e['user']['id'];if(!_0x109dcb||!_0x365ead)return console[_0x4704ee(0xc3)](_0x4704ee(0xc0),_0x365ead,_0x109dcb);const _0x25aa9c=await Users['findById']({'_id':_0x1a834e[_0x4704ee(0xe6)]['id']}),_0x1c69ea={'client_id':process['env'][_0x4704ee(0xf7)],'client_secret':process[_0x4704ee(0x138)][_0x4704ee(0xf2)],'grant_type':'authorization_code','redirect_uri':process[_0x4704ee(0x138)][_0x4704ee(0x126)]+'/settings','code':_0x365ead,'scope':_0x4704ee(0x170)};fetch(_0x4704ee(0x136),{'method':'POST','body':new URLSearchParams(_0x1c69ea),'headers':{'Content-Type':_0x4704ee(0xeb)}})[_0x4704ee(0x151)](_0x5f13e7=>_0x5f13e7['json']())[_0x4704ee(0x151)](async _0x197387=>{const _0x7b2e21=_0x4704ee,_0x288904=await fetch('http://discordapp.com/api/users/@me',{'headers':{'Authorization':_0x7b2e21(0xcb)+_0x197387[_0x7b2e21(0x177)]}}),_0x519248=await _0x288904[_0x7b2e21(0x182)](),_0x35290d=_0x519248['id'];if(!_0x35290d)return console[_0x7b2e21(0xc3)](_0x7b2e21(0xa9),_0x35290d);return await _0x4b5be4[_0x7b2e21(0x182)]({'msg':'Success'}),await Users[_0x7b2e21(0x125)]({'_id':_0x109dcb},{'$set':{'discordid':_0x35290d}}),await updateBotPermissions(),logger(_0x7b2e21(0x165),_0x25aa9c[_0x7b2e21(0xec)],0x0);});}catch(_0x2544ac){console[_0x4704ee(0xc3)](_0x2544ac);}},'removeDiscordAuth':async(_0x15f773,_0x10ec94)=>{const _0x5a48c4=a6_0x346cc9,{password:_0x1b66af}=_0x15f773['body'];if(!_0x1b66af)return;try{const _0x5b6e42=await Users[_0x5a48c4(0x137)]({'_id':_0x15f773['user']['id']}),_0x1127e1=await argon[_0x5a48c4(0x169)](_0x5b6e42[_0x5a48c4(0xb4)],_0x1b66af);if(!_0x1127e1)return _0x10ec94['status'](0x190)[_0x5a48c4(0x182)]({'msg':_0x5a48c4(0xd8)});return await Users['findOneAndUpdate']({'_id':_0x15f773['user']['id']},{'$unset':{'discordid':''}}),_0x10ec94[_0x5a48c4(0x182)]('Successfully\x20unlinked\x20Discord'),await updateBotPermissions(),logger('Discord\x20unlinked',_0x5b6e42[_0x5a48c4(0xec)],0x0);}catch(_0x264eb0){console['log'](_0x264eb0);}},'changePassword':async(_0x1081fb,_0x1b9c47)=>{const _0x7fe8cc=a6_0x346cc9;try{const {old_password:_0x3bbf90,new_password:_0x5d432c}=_0x1081fb[_0x7fe8cc(0xc2)],_0x216f96=await Users['findById']({'_id':_0x1081fb['user']['id']}),_0x5994e5=await argon[_0x7fe8cc(0x169)](_0x216f96[_0x7fe8cc(0xb4)],_0x3bbf90);if(!_0x5994e5)return _0x1b9c47[_0x7fe8cc(0xde)](0x190)[_0x7fe8cc(0x182)]({'msg':'Old\x20password\x20is\x20wrong.'});if(_0x3bbf90===_0x5d432c)return _0x1b9c47[_0x7fe8cc(0xde)](0x190)[_0x7fe8cc(0x182)]({'msg':_0x7fe8cc(0x19a)});const _0x1e799f=passwordValidate['validate']({'password':_0x5d432c});if(_0x1e799f[_0x7fe8cc(0x184)])return console[_0x7fe8cc(0xc3)](_0x1e799f['error']),_0x1b9c47['status'](0x1a6)['json']({'msg':_0x1e799f[_0x7fe8cc(0x184)][_0x7fe8cc(0xef)][0x0][_0x7fe8cc(0xae)]});const _0x4b4799=await argon[_0x7fe8cc(0x13a)](_0x5d432c);return await Users[_0x7fe8cc(0x125)]({'_id':_0x216f96[_0x7fe8cc(0xf4)]},{'$set':{'password':_0x4b4799}}),_0x1b9c47[_0x7fe8cc(0x182)]({'msg':_0x7fe8cc(0x14a)}),logger(_0x7fe8cc(0x17a),_0x216f96[_0x7fe8cc(0xec)],0x0);}catch(_0x4780e0){return console[_0x7fe8cc(0xc3)](_0x4780e0),_0x1b9c47['status'](0x1f4)[_0x7fe8cc(0x182)]({'msg':_0x4780e0[_0x7fe8cc(0xae)]});}},'createLicense':async(_0x57945f,_0xc8f028)=>{const _0x206f80=a6_0x346cc9,_0x125894=await Dashboard[_0x206f80(0x193)]({'webhook_state':!![]});if(!_0x125894)return;const {created_by:_0x146999}=_0x57945f[_0x206f80(0xc2)],{tags:_0x5987fa}=_0x57945f[_0x206f80(0xc2)];let {pre_ips:_0x5396b0}=_0x57945f[_0x206f80(0xc2)];_0x57945f[_0x206f80(0xc2)]=_0x57945f['body']['data'];let {clientname:_0x42e08f,discordid:_0x2c8118,expires:_0x43eb57,expires_delete_after:_0x4bb9df,expires_date:_0x5e726e,expires_days:_0x21eb20,expires_start_on_first:_0x46ff6b,expires_times:_0x48b5b1,description:_0x400c1e,expires_type:_0x38707b,hwid_cap:_0x555114,hwid_expires:_0x232769,ip_cap:_0x5a207a,ip_expires:_0x338f38,ip_geo_lock:_0x3188ce,prefer_discord:_0x504c6a,licensekey:_0x28cf80,product:_0x5441fb,receive_webhooks:_0xfde9ac}=_0x57945f[_0x206f80(0xc2)];const _0x3ef840=createlicenseValidate[_0x206f80(0x131)]({'licensekey':_0x28cf80,'clientname':_0x42e08f});if(_0x3ef840['error'])return console['log'](_0x3ef840[_0x206f80(0x184)]),_0xc8f028[_0x206f80(0xde)](0x190)[_0x206f80(0x182)]({'msg':_0x3ef840['error'][_0x206f80(0xef)][0x0]['message']});if(!isNaN(_0x42e08f))return _0xc8f028[_0x206f80(0xde)](0x190)['json']({'msg':'Clientname\x20cannot\x20contain\x20only\x20numbers!'});if(_0x400c1e&&_0x400c1e[_0x206f80(0xce)]>0x190)return _0xc8f028[_0x206f80(0xde)](0x190)[_0x206f80(0x182)]({'msg':_0x206f80(0xcf)});const _0x8faa72=await Products[_0x206f80(0x137)]({'_id':_0x5441fb});if(!_0x8faa72)return _0xc8f028[_0x206f80(0xde)](0x190)['json']({'msg':_0x206f80(0xd4)});const _0x48d920=_0x8faa72[_0x206f80(0xec)];let _0x103a5a,_0x3b5098;if(_0x2c8118!==''){const _0x495938=/^\d+$/[_0x206f80(0x161)](_0x2c8118);if(!_0x495938||_0x2c8118[_0x206f80(0xce)]<0x11||_0x2c8118[_0x206f80(0xce)]>0x14)return _0xc8f028[_0x206f80(0xde)](0x190)['json']({'msg':_0x206f80(0xa8)});await axios[_0x206f80(0x183)]('https://discordapp.com/api/users/'+_0x2c8118,{'headers':{'Authorization':_0x206f80(0x160)+process[_0x206f80(0x138)][_0x206f80(0xbd)]}})['then'](_0x15f493=>{const _0x5f4b02=_0x206f80;_0x103a5a=_0x15f493[_0x5f4b02(0x110)][_0x5f4b02(0xc1)];})[_0x206f80(0x13d)](_0x2942ac=>{const _0x35865c=_0x206f80;_0x2942ac['response']['data'][_0x35865c(0xae)][_0x35865c(0xad)]()==='unknown\x20user'&&(_0x103a5a=null,_0x3b5098=_0x35865c(0xa3));});}else _0x2c8118=null,_0x103a5a=null;if(_0x3b5098)return _0xc8f028[_0x206f80(0xde)](0x190)[_0x206f80(0x182)]({'msg':_0x3b5098});let _0x1a8856;if(!_0x5396b0||_0x5396b0[_0x206f80(0xce)]===0x0)_0x5396b0=undefined;else{_0x1a8856=[];for(let _0x5ab255=0x0;_0x5ab255<_0x5396b0['length'];_0x5ab255++){const _0x6c8932=_0x5396b0[_0x5ab255];_0x1a8856[_0x206f80(0x128)]({'ip':_0x6c8932,'created_at':new Date(),'expires_in':null});}}const _0x3050eb=await Licenses['find']();for(let _0x27a66b=0x0;_0x27a66b<_0x3050eb[_0x206f80(0xce)];_0x27a66b++){const _0x179634=_0x3050eb[_0x27a66b],_0x18fcac=await decrypt(_0x179634[_0x206f80(0x179)]);if(_0x28cf80===_0x18fcac)return _0xc8f028['status'](0x190)['json']({'msg':_0x206f80(0xd1)});}function _0x5ce685(_0x340b0d,_0x29bbc7){const _0x48f80f=_0x206f80,_0x19372a=new Date(_0x340b0d);return _0x19372a[_0x48f80f(0x145)](_0x19372a['getDate']()+_0x29bbc7),_0x19372a;}if(_0x43eb57==='true'){_0x43eb57=!![],_0x38707b=parseInt(_0x38707b);if(_0x38707b===0x1)_0x46ff6b==='true'?_0x5e726e=undefined:_0x5e726e=_0x5ce685(new Date(),parseInt(_0x21eb20)),_0x48b5b1=undefined;else{if(_0x38707b===0x2)_0x21eb20=undefined,_0x46ff6b=undefined,_0x48b5b1=undefined;else _0x38707b===0x3&&(_0x21eb20=undefined,_0x46ff6b=undefined,_0x5e726e=undefined);}}_0x43eb57==='false'&&(_0x43eb57=![],_0x38707b=undefined,_0x21eb20=undefined,_0x46ff6b=undefined,_0x5e726e=undefined,_0x48b5b1=undefined);if(_0x5a207a==='∞')_0x5a207a=null,_0x338f38=undefined;else{_0x5a207a=parseInt(_0x5a207a);if(_0x5a207a<0x1)return _0xc8f028[_0x206f80(0xde)](0x190)[_0x206f80(0x182)]({'msg':_0x206f80(0xfe)});_0x338f38==='∞'?_0x338f38=null:_0x338f38=parseInt(_0x338f38);if(_0x338f38&&_0x338f38<0x1)return _0xc8f028[_0x206f80(0xde)](0x190)[_0x206f80(0x182)]({'msg':_0x206f80(0x147)});}(_0x3188ce===_0x206f80(0xb9)||_0x3188ce===null)&&(_0x3188ce=null);if(_0x555114==='∞')_0x555114=null,_0x232769=undefined;else{_0x555114=parseInt(_0x555114);if(_0x555114<0x1)return _0xc8f028[_0x206f80(0xde)](0x190)[_0x206f80(0x182)]({'msg':_0x206f80(0xcd)});_0x232769==='∞'?_0x232769=null:_0x232769=parseInt(_0x232769);if(_0x232769&&_0x232769<0x1)return _0xc8f028[_0x206f80(0xde)](0x190)['json']({'msg':_0x206f80(0x180)});}const _0x12b287=_0x8faa72[_0x206f80(0xe5)]*(0x1-_0x8faa72['discount']/0x64),_0x32a466=encrypt(_0x28cf80);await Dashboard[_0x206f80(0x119)]({'$inc':{'current_id':0x1}});const _0x55e26a=await Dashboard[_0x206f80(0xdc)](),_0x27d904=_0x55e26a[0x0][_0x206f80(0x12f)],_0x2fcde5=_0x206f80(0xd5),_0x50ed8b=(_0x2fcde5+_0x27d904)['substr'](String(_0x27d904)[_0x206f80(0xce)]),_0x1a9207=new Licenses({'product':_0x5441fb,'product_name':_0x48d920,'licensekey':_0x32a466,'clientname':_0x42e08f,'discord_id':_0x2c8118,'discord_username':_0x103a5a,'prefer_discord':_0x504c6a,'license_id':'UL'+_0x50ed8b,'receive_webhooks':_0xfde9ac,'description':_0x400c1e,'expires':_0x43eb57,'expires_delete_after':_0x4bb9df,'expires_type':_0x38707b,'expires_days':_0x21eb20,'expires_start_on_first':_0x46ff6b,'expires_date':_0x5e726e,'expires_times':_0x48b5b1,'ip_cap':_0x5a207a,'ip_expires':_0x338f38,'ip_geo_lock':_0x3188ce,'hwid_cap':_0x555114,'hwid_expires':_0x232769,'tags':_0x5987fa,'latest_request':undefined,'payment_sum':_0x12b287,'lastest_hwid':null,'lastest_ip':null,'ip_list':_0x1a8856||[],'hwid_list':[],'total_requests':0x0,'created_by':_0x146999});await _0x1a9207['save'](),await Users[_0x206f80(0x125)]({'_id':_0x57945f['user']['id']},{'$inc':{'licenses_added':0x1,'revenue':_0x12b287}}),await Products[_0x206f80(0x125)]({'_id':_0x5441fb},{'$inc':{'total_purchases':0x1,'total_gross':_0x12b287}}),_0xc8f028[_0x206f80(0x182)]({'msg':'Licensekey\x20successfully\x20added'}),logger('License\x20created',_0x146999,0x0);},'updateLicense':async(_0x13543e,_0x5ab288)=>{const _0xf9303a=a6_0x346cc9;let {licensekey:_0x1af99c,clientname:_0x48ec9b,product:_0x144f51,discord_id:_0x9f70fd,description:_0x1ba205,ip_cap:_0x1b2f70,ip_expires:_0x4dfba5,ip_geo_lock:_0x27d0a2,hwid_cap:_0x49ab60,hwid_expires:_0xbaf9f6,expires:_0x573457,expires_type:_0x51a8bc,receive_webhooks:_0x19923a,expires_delete_after:_0x4931d3,prefer_discord:_0x37fcdb,expires_date:_0x290917,expires_times:_0x2f454c,created_by:_0x54c04c,_id:_0x36ab21}=_0x13543e[_0xf9303a(0xc2)][_0xf9303a(0x110)];const {tags:_0x2d67a2}=_0x13543e['body'],{days:_0x4b28a6,times:_0x184f05}=_0x13543e[_0xf9303a(0xc2)][_0xf9303a(0xa4)],_0x2eff9f=await Licenses[_0xf9303a(0x137)]({'_id':_0x36ab21});if(!_0x2eff9f)return _0x5ab288[_0xf9303a(0xde)](0x190)[_0xf9303a(0x182)]({'msg':_0xf9303a(0xe9)});if(!_0x48ec9b||_0x48ec9b[_0xf9303a(0xce)]<0x3||_0x48ec9b[_0xf9303a(0xce)]>0x1e)return _0x5ab288[_0xf9303a(0xde)](0x190)[_0xf9303a(0x182)]({'msg':'Invalid\x20client\x20name'});const _0x29830f=await Products[_0xf9303a(0x137)]({'_id':_0x144f51}),_0x3406c4=_0x29830f[_0xf9303a(0xec)];if(!_0x144f51||!_0x29830f)return _0x5ab288[_0xf9303a(0xde)](0x190)[_0xf9303a(0x182)]({'msg':'Invalid\x20product'});if(_0x1ba205&&_0x1ba205[_0xf9303a(0xce)]>0x190)return _0x5ab288[_0xf9303a(0xde)](0x190)['json']({'msg':_0xf9303a(0xcf)});let _0x25364f,_0x1d3781;if(_0x9f70fd&&_0x9f70fd!==''){const _0x58c053=/^\d+$/[_0xf9303a(0x161)](_0x9f70fd);if(!_0x58c053||_0x9f70fd[_0xf9303a(0xce)]<0x11||_0x9f70fd[_0xf9303a(0xce)]>0x14)return _0x5ab288[_0xf9303a(0xde)](0x190)[_0xf9303a(0x182)]({'msg':_0xf9303a(0xa8)});await axios[_0xf9303a(0x183)]('https://discordapp.com/api/users/'+_0x9f70fd,{'headers':{'Authorization':_0xf9303a(0x160)+process[_0xf9303a(0x138)]['DISCORD_BOT_TOKEN']}})['then'](_0x2f2ff4=>{const _0x848ae7=_0xf9303a;_0x25364f=_0x2f2ff4[_0x848ae7(0x110)][_0x848ae7(0xc1)];})[_0xf9303a(0x13d)](_0x39dee9=>{const _0x10aaa3=_0xf9303a;_0x39dee9[_0x10aaa3(0x130)][_0x10aaa3(0x110)][_0x10aaa3(0xae)][_0x10aaa3(0xad)]()===_0x10aaa3(0x107)&&(_0x25364f=null,_0x1d3781='DiscordID\x20did\x20not\x20match\x20any\x20existing\x20user');});}else _0x9f70fd=null,_0x25364f=null;if(_0x1d3781)return _0x5ab288[_0xf9303a(0xde)](0x190)['json']({'msg':_0x1d3781});(!_0x37fcdb||_0x37fcdb===_0xf9303a(0x149))&&(_0x37fcdb=![]);_0x37fcdb&&_0x37fcdb==='true'&&(_0x37fcdb=!![]);if(!_0x1b2f70||_0x1b2f70==='none'||_0x1b2f70==='')_0x1b2f70=null,_0x4dfba5=undefined;else{if(parseInt(_0x1b2f70)<_0x2eff9f[_0xf9303a(0xf8)][_0xf9303a(0xce)])return _0x5ab288[_0xf9303a(0xde)](0x190)[_0xf9303a(0x182)]({'msg':_0xf9303a(0x148)});}if(!_0x49ab60||_0x49ab60===_0xf9303a(0x16f)||_0x49ab60==='')_0x49ab60=null,_0xbaf9f6=undefined;else{if(parseInt(_0x49ab60)<_0x2eff9f[_0xf9303a(0x120)][_0xf9303a(0xce)])return _0x5ab288[_0xf9303a(0xde)](0x190)[_0xf9303a(0x182)]({'msg':'HWID-Cap\x20cannot\x20be\x20lower\x20that\x20current\x20amount\x20of\x20HWIDs'});}(!_0x27d0a2||_0x27d0a2===_0xf9303a(0x16f)||_0x27d0a2==='')&&(_0x27d0a2=null);async function _0x52d4c7(_0x5f45a2,_0x20687c){const _0x352948=_0xf9303a,_0x4cb422=new Date(_0x5f45a2);return _0x4cb422[_0x352948(0x145)](_0x4cb422[_0x352948(0xdd)]()+_0x20687c),_0x4cb422;}if(_0x2eff9f[_0xf9303a(0xfa)]){if(_0x573457===!![]||_0x573457===_0xf9303a(0x12b)){if(parseInt(_0x51a8bc)===0x1){if(!_0x290917)return _0x5ab288[_0xf9303a(0xde)](0x190)[_0xf9303a(0x182)]({'msg':'This\x20license\x20havent\x20started\x20expiring\x20yet'});_0x290917=await _0x52d4c7(_0x290917,_0x4b28a6),await Licenses[_0xf9303a(0x125)]({'_id':_0x36ab21},{'$set':{'expires_date':_0x290917}});}if(parseInt(_0x51a8bc)===0x2){if(Date[_0xf9303a(0x16c)](_0x290917)<new Date())return _0x5ab288[_0xf9303a(0xde)](0x190)[_0xf9303a(0x182)]({'msg':_0xf9303a(0x156)});await Licenses[_0xf9303a(0x125)]({'_id':_0x36ab21},{'$set':{'expires_date':_0x290917}});}parseInt(_0x51a8bc)===0x3&&(_0x2f454c=parseInt(_0x2f454c)+parseInt(_0x184f05),await Licenses[_0xf9303a(0x125)]({'_id':_0x36ab21},{'$set':{'expires_times':_0x2f454c}}));}else await Licenses[_0xf9303a(0x125)]({'_id':_0x36ab21},{'$set':{'expires':![]},'$unset':{'expires_type':'','expires_days':'','expires_start_on_first':'','expires_times':'','expires_date':''}});}else{if(_0x573457===!![]||_0x573457===_0xf9303a(0x12b)){let _0x4dbbd5;!_0x51a8bc&&(_0x51a8bc=0x1);if(parseInt(_0x51a8bc)===0x1){if(parseInt(_0x4b28a6)<0x1)return _0x5ab288['status'](0x190)['json']({'msg':_0xf9303a(0xea)});_0x4dbbd5={'expires':!![],'expires_type':0x1,'expires_date':await _0x52d4c7(new Date(),_0x4b28a6)};}else{if(parseInt(_0x51a8bc)===0x2){if(Date[_0xf9303a(0x16c)](_0x290917)<new Date())return _0x5ab288['status'](0x190)[_0xf9303a(0x182)]({'msg':_0xf9303a(0x156)});_0x4dbbd5={'expires':!![],'expires_type':0x2,'expires_date':_0x290917};}else{if(parseInt(_0x2f454c)<0x1)return _0x5ab288[_0xf9303a(0xde)](0x190)[_0xf9303a(0x182)]({'msg':'Expires\x20times\x20must\x20be\x20greated\x20than\x200!'});_0x4dbbd5={'expires':!![],'expires_type':0x3,'expires_times':_0x184f05,'total_requests':0x0};}}await Licenses['findByIdAndUpdate']({'_id':_0x36ab21},{'$set':_0x4dbbd5});}}try{await Licenses['findByIdAndUpdate']({'_id':_0x36ab21},{'$set':{'clientname':_0x48ec9b,'product':_0x144f51,'product_name':_0x3406c4,'discord_id':_0x9f70fd,'description':_0x1ba205,'discord_username':_0x25364f,'ip_cap':_0x1b2f70,'ip_expires':_0x4dfba5,'ip_geo_lock':_0x27d0a2,'hwid_cap':_0x49ab60,'hwid_expires':_0xbaf9f6,'receive_webhooks':_0x19923a,'expires_delete_after':_0x4931d3,'prefer_discord':_0x37fcdb,'tags':_0x2d67a2||[]}});const _0x5be770=await Licenses[_0xf9303a(0x137)]({'_id':_0x36ab21});_0x5be770[_0xf9303a(0x179)]=_0x1af99c,_0x5ab288[_0xf9303a(0x182)]({'msg':'Successfully\x20updated\x20license','data':_0x5be770}),logger('License\x20updated',_0x54c04c,0x0);}catch(_0x4634e6){console[_0xf9303a(0xc3)](_0x4634e6);}},'clearHwids':async(_0x1baaff,_0x3e475a)=>{const _0x190770=a6_0x346cc9,_0x442051=_0x1baaff[_0x190770(0xc2)][_0x190770(0x110)],_0x259806=await Users[_0x190770(0x193)]({'_id':_0x1baaff[_0x190770(0xe6)]['id']});if(!_0x442051)return _0x3e475a[_0x190770(0xde)](0x190)[_0x190770(0x182)]({'msg':_0x190770(0x194)});try{await Licenses['findByIdAndUpdate']({'_id':_0x442051['_id']},{'$set':{'hwid_list':[],'latest_hwid':null}});const _0x2bed7f=await Licenses['findById']({'_id':_0x442051['_id']});_0x3e475a[_0x190770(0x182)]({'msg':_0x190770(0x150),'data':_0x2bed7f}),logger('License\x20HWIDs\x20cleared',_0x259806['name'],0x0);}catch(_0x24e700){console[_0x190770(0xc3)](_0x24e700);}},'clearIps':async(_0xca1b45,_0x49ac82)=>{const _0x500416=a6_0x346cc9,_0xfb54aa=_0xca1b45[_0x500416(0xc2)][_0x500416(0x110)],_0x5745b5=await Users[_0x500416(0x193)]({'_id':_0xca1b45[_0x500416(0xe6)]['id']});if(!_0xfb54aa)return _0x49ac82[_0x500416(0xde)](0x190)['json']({'msg':_0x500416(0x194)});try{await Licenses[_0x500416(0x125)]({'_id':_0xfb54aa[_0x500416(0xf4)]},{'$set':{'ip_list':[],'latest_ip':null}});const _0x4bdd3f=await Licenses[_0x500416(0x137)]({'_id':_0xfb54aa[_0x500416(0xf4)]});_0x49ac82[_0x500416(0x182)]({'msg':_0x500416(0x166),'data':_0x4bdd3f}),logger(_0x500416(0xaf),_0x5745b5[_0x500416(0xec)],0x0);}catch(_0x250efe){console[_0x500416(0xc3)](_0x250efe);}},'resetLicense':async(_0x319542,_0x10100a)=>{const _0x5c395e=a6_0x346cc9,_0x4fd3b7=_0x319542['body']['data'],_0x5f1be0=await Users[_0x5c395e(0x193)]({'_id':_0x319542['user']['id']});if(!_0x4fd3b7)return _0x10100a[_0x5c395e(0xde)](0x190)[_0x5c395e(0x182)]({'msg':_0x5c395e(0x194)});try{const _0x17d180=await generateProductKey(0x5,0x5),_0xe47cd5=await encrypt(_0x17d180);await Licenses[_0x5c395e(0x125)]({'_id':_0x4fd3b7[_0x5c395e(0xf4)]},{'$set':{'licensekey':_0xe47cd5}});const _0x4ea9a7=await Licenses[_0x5c395e(0x137)]({'_id':_0x4fd3b7[_0x5c395e(0xf4)]});_0x4ea9a7[_0x5c395e(0x179)]=_0x17d180,_0x10100a[_0x5c395e(0x182)]({'msg':_0x5c395e(0x155),'data':_0x4ea9a7}),logger('License\x20reset',_0x5f1be0['name'],0x0);}catch(_0x2f5b06){console[_0x5c395e(0xc3)](_0x2f5b06);}},'deleteLicense':async(_0x3aa148,_0x27273b)=>{const _0x3b4c4e=a6_0x346cc9,_0x4fc33b=_0x3aa148['body'][_0x3b4c4e(0x11c)],_0x2153e0=await Users['findOne']({'_id':_0x3aa148['user']['id']});if(!_0x4fc33b)return _0x27273b[_0x3b4c4e(0xde)](0x190)['json']({'msg':_0x3b4c4e(0x194)});try{await Licenses['findByIdAndDelete']({'_id':_0x4fc33b}),_0x27273b[_0x3b4c4e(0x182)]({'msg':_0x3b4c4e(0xd7)}),logger(_0x3b4c4e(0xac),_0x2153e0['name'],0x0);}catch(_0x33614f){console['log'](_0x33614f);}},'getLicenses':async(_0x5dbfa2,_0x5b8750)=>{const _0x3cf62b=a6_0x346cc9;try{const _0x4cd8a7=parseInt(_0x5dbfa2[_0x3cf62b(0x139)]['page']),_0xcd9ae=parseInt(_0x5dbfa2[_0x3cf62b(0x139)]['limit']),{query:_0x4d5ad5}=_0x5dbfa2[_0x3cf62b(0x139)],{product:_0xa1fc18}=_0x5dbfa2['query'],{sortby:_0x446a6f}=_0x5dbfa2[_0x3cf62b(0x139)],_0x53c99b=(_0x4cd8a7-0x1)*_0xcd9ae,_0x7222da=_0x4cd8a7*_0xcd9ae,_0x2a6209={};let _0x531be5;if(_0x446a6f===_0x3cf62b(0x185))_0x531be5=await Licenses[_0x3cf62b(0xdc)]()['sort']({'_id':-0x1});else _0x446a6f===_0x3cf62b(0xec)&&(_0x531be5=await Licenses[_0x3cf62b(0xdc)]()[_0x3cf62b(0x15b)]({'locale':'en'})['sort']({'clientname':0x1}));const _0x16ef23=[];for(let _0x3fd809=0x0;_0x3fd809<_0x531be5['length'];_0x3fd809++){const _0x389a51=_0x531be5[_0x3fd809];if(_0xa1fc18&&_0xa1fc18!==''&&_0xa1fc18!=='undefined'){if(_0x389a51[_0x3cf62b(0x105)]!==_0xa1fc18)continue;}_0x4d5ad5===''||_0x4d5ad5===undefined?(_0x389a51[_0x3cf62b(0x179)]=decrypt(_0x389a51['licensekey']),_0x16ef23[_0x3cf62b(0x128)](_0x389a51)):(_0x389a51['licensekey']=decrypt(_0x389a51[_0x3cf62b(0x179)]),(_0x389a51[_0x3cf62b(0x179)][_0x3cf62b(0xad)]()['includes'](_0x4d5ad5[_0x3cf62b(0xad)]())||_0x389a51[_0x3cf62b(0x11a)][_0x3cf62b(0xad)]()[_0x3cf62b(0x168)](_0x4d5ad5[_0x3cf62b(0xad)]()))&&_0x16ef23[_0x3cf62b(0x128)](_0x389a51));}return _0x7222da<_0x16ef23[_0x3cf62b(0xce)]&&(_0x2a6209[_0x3cf62b(0x14c)]={'page':_0x4cd8a7+0x1,'limit':_0xcd9ae}),_0x53c99b>0x0&&(_0x2a6209[_0x3cf62b(0x114)]={'page':_0x4cd8a7-0x1,'limit':_0xcd9ae}),_0x2a6209[_0x3cf62b(0xb8)]=_0x16ef23['slice'](_0x53c99b,_0x7222da),_0x5b8750['json']({'licenses':_0x2a6209,'total':_0x16ef23[_0x3cf62b(0xce)]});}catch(_0x5bb4b3){console['log'](_0x5bb4b3);}},'createProduct':async(_0x581543,_0xa797a2)=>{const _0x174109=a6_0x346cc9,_0x5d7ceb=await Dashboard[_0x174109(0x193)]({'webhook_state':!![]});if(!_0x5d7ceb)return;const {created_by:_0x41bb53}=_0x581543[_0x174109(0xc2)];_0x581543[_0x174109(0xc2)]=_0x581543['body'][_0x174109(0x110)];const {price:_0x5b7a14,version:_0x3230df,name:_0x21a204}=_0x581543[_0x174109(0xc2)];if(isNaN(_0x5b7a14))return _0xa797a2[_0x174109(0xde)](0x190)[_0x174109(0x182)]({'msg':_0x174109(0x187)});if(_0x21a204[_0x174109(0xce)]<0x3)return _0xa797a2[_0x174109(0xde)](0x190)[_0x174109(0x182)]({'msg':_0x174109(0xbf)});if(_0x3230df[_0x174109(0xce)]<0x3)return _0xa797a2[_0x174109(0xde)](0x190)['json']({'msg':_0x174109(0xb2)});const _0x1bb4bb=await Products[_0x174109(0x193)]({'name':_0x21a204});if(_0x1bb4bb)return _0xa797a2[_0x174109(0xde)](0x190)['json']({'msg':_0x174109(0xfc)});const _0x423904=new Products({'name':_0x21a204,'version':_0x3230df,'price':_0x5b7a14,'discount':0x0,'total_purchases':0x0,'total_gross':0x0,'created_by':_0x41bb53});await _0x423904[_0x174109(0x11f)](),_0xa797a2[_0x174109(0x182)]({'msg':'Product\x20successfully\x20added'});const _0x3dc2b9=await Users[_0x174109(0x193)]({'_id':_0x581543[_0x174109(0xe6)]['id']});logger(_0x174109(0x14e),_0x3dc2b9[_0x174109(0xec)],0x0);},'getProducts':async(_0x4427fb,_0x4933c9)=>{const _0x10d548=a6_0x346cc9;try{const _0x1915c7=await Products['find'](),_0x3243da=await Products[_0x10d548(0xdc)]()[_0x10d548(0x192)]({'$natural':-0x1})[_0x10d548(0x17f)](0x1);_0x4933c9[_0x10d548(0x182)]({'products':_0x1915c7,'latest':_0x3243da[0x0]?.[_0x10d548(0xec)]});}catch(_0x18d060){console[_0x10d548(0xc3)](_0x18d060);}},'deleteProduct':async(_0x5591dd,_0x4bdd88)=>{const _0x37ccf9=a6_0x346cc9,{product:_0x53d27c}=_0x5591dd[_0x37ccf9(0xc2)];try{const _0x21b1be=await Licenses[_0x37ccf9(0xdc)]();for(let _0x45b2be=0x0;_0x45b2be<_0x21b1be[_0x37ccf9(0xce)];_0x45b2be++){const _0x486de2=_0x21b1be[_0x45b2be];if(_0x486de2[_0x37ccf9(0x105)]===_0x53d27c)return _0x4bdd88[_0x37ccf9(0xde)](0x190)[_0x37ccf9(0x182)]({'msg':_0x37ccf9(0x173)});}await Products['findByIdAndDelete']({'_id':_0x53d27c}),_0x4bdd88[_0x37ccf9(0x182)]({'msg':_0x37ccf9(0x152)});const _0x3e58e8=await Users['findOne']({'_id':_0x5591dd[_0x37ccf9(0xe6)]['id']});logger(_0x37ccf9(0xf0),_0x3e58e8[_0x37ccf9(0xec)],0x0);}catch(_0x303c2b){console[_0x37ccf9(0xc3)](_0x303c2b);}},'updateProduct':async(_0x248075,_0x4d87fa)=>{const _0x575648=a6_0x346cc9,{name:_0x2f1842,version:_0x4560d6,discount:_0x109e31,price:_0x32da83,_id:_0x2faf97}=_0x248075[_0x575648(0xc2)][_0x575648(0x197)];if(isNaN(_0x32da83))return _0x4d87fa[_0x575648(0xde)](0x190)['json']({'msg':_0x575648(0x187)});if(_0x2f1842[_0x575648(0xce)]<0x3)return _0x4d87fa[_0x575648(0xde)](0x190)[_0x575648(0x182)]({'msg':_0x575648(0xbf)});if(_0x4560d6[_0x575648(0xce)]<0x3)return _0x4d87fa[_0x575648(0xde)](0x190)[_0x575648(0x182)]({'msg':_0x575648(0xb2)});if(isNaN(_0x109e31))return _0x4d87fa[_0x575648(0xde)](0x190)[_0x575648(0x182)]({'msg':_0x575648(0x16d)});const _0x1d1c00=await Products[_0x575648(0xdc)]({'name':_0x2f1842});if(_0x1d1c00&&_0x1d1c00[_0x575648(0xce)]>0x1)return _0x4d87fa[_0x575648(0xde)](0x190)[_0x575648(0x182)]({'msg':_0x575648(0xcc)+_0x2f1842});try{await Products['findByIdAndUpdate']({'_id':_0x2faf97},{'$set':{'name':_0x2f1842,'version':_0x4560d6,'discount':_0x109e31,'price':_0x32da83}}),_0x4d87fa['json']({'msg':'Successfully\x20edited\x20product'});const _0x4f1a62=await Products[_0x575648(0x193)]({'_id':_0x2faf97});_0x4f1a62&&await Licenses[_0x575648(0x196)]({'product':_0x4f1a62[_0x575648(0xf4)]},{'$set':{'product_name':_0x2f1842}});const _0x2d4ee3=await Users['findOne']({'_id':_0x248075[_0x575648(0xe6)]['id']});logger(_0x575648(0x13c),_0x2d4ee3['name'],0x0);}catch(_0x5e9feb){console[_0x575648(0xc3)](_0x5e9feb);}},'createUser':async(_0x20067e,_0x2f84e3)=>{const _0x1f5116=a6_0x346cc9,{created_by:_0x5b30fa}=_0x20067e['body'],{name:_0x5e07a5,email:_0x500ad4,password1:_0x2926e4,password2:_0x3b6ed4,permission:_0x401f18}=_0x20067e['body'][_0x1f5116(0x110)];if(_0x2926e4!==_0x3b6ed4)return _0x2f84e3[_0x1f5116(0xde)](0x190)[_0x1f5116(0x182)]({'msg':_0x1f5116(0x12a)});const _0x11aefb=loginSchema[_0x1f5116(0x131)]({'email':_0x500ad4,'password':_0x2926e4});if(_0x11aefb[_0x1f5116(0x184)])return console['log'](_0x11aefb[_0x1f5116(0x184)]),_0x2f84e3[_0x1f5116(0xde)](0x1a6)[_0x1f5116(0x182)]({'msg':_0x11aefb[_0x1f5116(0x184)][_0x1f5116(0xef)][0x0][_0x1f5116(0xae)]});const _0x5bd638=await Users['findById']({'_id':_0x20067e['user']['id']});if(_0x5bd638['role']!==0x0)return _0x2f84e3['status'](0x190)[_0x1f5116(0x182)]({'msg':_0x1f5116(0x121)});const _0x275e93=await Users['findOne']({'email':_0x500ad4});if(_0x275e93)return _0x2f84e3[_0x1f5116(0xde)](0x190)['json']({'msg':_0x1f5116(0xa5)});const _0xe74ae8=await argon[_0x1f5116(0x13a)](_0x2926e4),_0x15048e=new Users({'name':_0x5e07a5,'email':_0x500ad4,'password':_0xe74ae8,'twofactor':![],'role':_0x401f18,'created_by':_0x5b30fa});await _0x15048e[_0x1f5116(0x11f)](),_0x2f84e3[_0x1f5116(0x182)]({'msg':'Successfully\x20added\x20a\x20new\x20user'}),logger(_0x1f5116(0x129),_0x5bd638[_0x1f5116(0xec)],0x0);},'deleteUser':async(_0xaabe5e,_0x4159fd)=>{const _0x439e57=a6_0x346cc9,{email:_0x13ac95}=_0xaabe5e[_0x439e57(0xc2)][_0x439e57(0xe6)],_0x377688=await Users[_0x439e57(0x193)]({'_id':_0xaabe5e[_0x439e57(0xe6)]['id']});if(!_0x377688||_0x377688[_0x439e57(0x146)]!==0x0)return _0x4159fd[_0x439e57(0xde)](0x1f4)['json']({'msg':_0x439e57(0xbb)});const _0x19218f=await Users[_0x439e57(0x193)]({'email':_0x13ac95});if(!_0x19218f[_0x439e57(0x135)])return _0x4159fd[_0x439e57(0xde)](0x190)['json']({'msg':'You\x20cannot\x20delete\x20root\x20user'});await Users[_0x439e57(0xc9)]({'email':_0x13ac95}),_0x4159fd[_0x439e57(0x182)]({'msg':_0x439e57(0x199)});const _0x2fa0d7=await Users[_0x439e57(0x193)]({'_id':_0xaabe5e['user']['id']});await updateBotPermissions(),logger(_0x439e57(0x15f),_0x2fa0d7[_0x439e57(0xec)],0x0);},'getUsers':async(_0x12a3ff,_0x578e21)=>{const _0x2f6f5a=a6_0x346cc9;try{const _0x4314a4=await Users[_0x2f6f5a(0xdc)]()['select'](_0x2f6f5a(0xe3));_0x578e21['json']({'users':_0x4314a4});}catch(_0x5b0c1d){console[_0x2f6f5a(0xc3)](_0x5b0c1d);}},'updateUser':async(_0x5f4919,_0x6af529)=>{const _0x1b3841=a6_0x346cc9,{name:_0x11dddf,email:_0x23cc41,role:_0x1e468c,_id:_0xdb08a0}=_0x5f4919[_0x1b3841(0xc2)][_0x1b3841(0x197)],_0x437419=await Users[_0x1b3841(0x193)]({'_id':_0x5f4919['user']['id']});if(!_0x437419||_0x437419[_0x1b3841(0x146)]!==0x0)return _0x6af529['status'](0x1f4)[_0x1b3841(0x182)]({'msg':_0x1b3841(0xbb)});if(_0x11dddf&&_0x11dddf[_0x1b3841(0xce)]<0x3)return _0x6af529['status'](0x190)['json']({'msg':_0x1b3841(0x190)});const _0x126871=emailValidate[_0x1b3841(0x131)]({'email':_0x23cc41});if(_0x126871[_0x1b3841(0x184)])return console[_0x1b3841(0xc3)](_0x126871['error']),_0x6af529['status'](0x1a6)[_0x1b3841(0x182)]({'msg':_0x126871[_0x1b3841(0x184)]['details'][0x0][_0x1b3841(0xae)]});const _0x1a62c5=await Users['findById']({'_id':_0xdb08a0});if(!_0x1a62c5['created_by']){if(parseInt(_0x1e468c)!==_0x1a62c5['role'])return _0x6af529[_0x1b3841(0xde)](0x190)['json']({'msg':_0x1b3841(0xbe)});}if(_0x1a62c5['_id']===_0xdb08a0){if(parseInt(_0x1e468c)!==_0x1a62c5[_0x1b3841(0x146)])return _0x6af529['status'](0x190)[_0x1b3841(0x182)]({'msg':_0x1b3841(0xfb)});}const _0x340bd4=await Users[_0x1b3841(0x193)]({'email':_0x23cc41});if(_0x1a62c5[_0x1b3841(0xa6)]!==_0x23cc41&&_0x340bd4)return _0x6af529[_0x1b3841(0xde)](0x190)[_0x1b3841(0x182)]({'msg':'That\x20email\x20already\x20exists!'});await Users['findByIdAndUpdate']({'_id':_0xdb08a0},{'$set':{'email':_0x23cc41,'name':_0x11dddf,'role':_0x1e468c}}),_0x6af529[_0x1b3841(0x182)]({'msg':_0x1b3841(0x134)});const _0x1da5fa=await Users[_0x1b3841(0x193)]({'_id':_0x5f4919[_0x1b3841(0xe6)]['id']});logger('User\x20updated',_0x1da5fa[_0x1b3841(0xec)],0x0);},'getDashboardData':async(_0x22c3cb,_0x2973af)=>{const _0x4576ec=a6_0x346cc9,_0x3175ec=await Licenses[_0x4576ec(0xdc)]()['sort']({'_id':-0x1}),_0x13cbce=_0x3175ec[_0x4576ec(0xce)];let _0x49e816;if(_0x3175ec&&_0x3175ec[_0x4576ec(0xce)]>0x0){const _0xc2ad37=[];for(let _0xdd13c8=0x0;_0xdd13c8<_0x3175ec['length'];_0xdd13c8++){const _0x5c2cb1=_0x3175ec[_0xdd13c8];if(moment(_0x5c2cb1[_0x4576ec(0xa7)])[_0x4576ec(0xe8)]('WW')===moment()['format']('WW'))_0xc2ad37['push'](_0x5c2cb1[_0x4576ec(0xd9)]);else break;}const _0x5c6871=_0xc2ad37['reduce']((_0x183478,_0x2affa9)=>_0x183478+_0x2affa9,0x0);_0x49e816=_0x5c6871[_0x4576ec(0x18f)](0x2);}else _0x49e816=0x0;let _0x103274=0x0,_0xf43fb=0x0,_0x2edf05=0x0;if(_0x3175ec&&_0x3175ec[_0x4576ec(0xce)]>0x0){const _0x5589fc=[];let _0x2f4dfa=0x0;for(let _0x2ddce0=0x0;_0x2ddce0<_0x3175ec[_0x4576ec(0xce)];_0x2ddce0++){const _0x5e1b42=_0x3175ec[_0x2ddce0];if(moment(_0x5e1b42[_0x4576ec(0xa7)])[_0x4576ec(0xe8)]('MM')===moment()[_0x4576ec(0xe8)]('MM'))_0x5589fc['push'](_0x5e1b42[_0x4576ec(0xd9)]),_0x2f4dfa+=0x1;else{if(moment(_0x5e1b42['createdAt'])[_0x4576ec(0xe8)]('MM')===moment()['subtract'](0x1,_0x4576ec(0xe7))[_0x4576ec(0xe8)]('MM'))_0x2edf05+=0x1;else break;}}const _0x3fcfa0=_0x5589fc[_0x4576ec(0x140)]((_0x32e952,_0x1996e7)=>_0x32e952+_0x1996e7,0x0);_0x103274=_0x3fcfa0[_0x4576ec(0x18f)](0x2),_0xf43fb=_0x2f4dfa;}else _0x103274=0x0,_0xf43fb=0x0;_0x2edf05=(_0xf43fb-_0x2edf05)/_0x2edf05*0x64;const _0x51768b=await Products[_0x4576ec(0xdc)]()[_0x4576ec(0x192)]({'total_purchases':-0x1});let _0x639995=0x0;for(let _0x4d7819=0x0;_0x4d7819<_0x51768b['length'];_0x4d7819++){const _0x485e46=_0x51768b[_0x4d7819];_0x639995+=_0x485e46[_0x4576ec(0x17d)];}const _0x496251=await Logs[_0x4576ec(0xdc)]()['sort']({'_id':-0x1}),_0x544a63=_0x496251['slice'](0x0,0x6),_0x4dab29=[],_0x5b0adc=[];if(_0x51768b)for(let _0x102251=0x0;_0x102251<_0x51768b[_0x4576ec(0xce)];_0x102251++){const _0x1cc182=_0x51768b[_0x102251];_0x4dab29[_0x4576ec(0x128)](_0x1cc182[_0x4576ec(0xec)]),_0x5b0adc[_0x4576ec(0x128)](_0x1cc182['total_purchases']/_0x639995*0x64);}const _0x3ed074=await Requests[_0x4576ec(0xdc)]({'date':new Date()[_0x4576ec(0x181)]()});let _0x10d10a=[];_0x3ed074[0x0]&&(_0x10d10a=_0x3ed074[0x0]['requests'][_0x4576ec(0xb0)](-0x6));_0x10d10a[_0x4576ec(0xb7)]();const _0x29c070=_0x3175ec[_0x4576ec(0xb0)](0x0,0x6),_0xa5d87a=await Dashboard[_0x4576ec(0x193)](),{license_goal_monthly:_0x31d6af}=_0xa5d87a;_0x2973af[_0x4576ec(0x182)]({'total_licenses':_0x13cbce,'weekly_earnings':_0x49e816,'monthly_earnings':_0x103274,'monthly_licenses':_0xf43fb,'last_month':_0x2edf05,'best_product':_0x51768b[0x0],'top_products_names':_0x4dab29,'top_products_values':_0x5b0adc,'total_purchases':_0x639995,'license_goal_monthly':_0x31d6af,'latest_requests_list':_0x10d10a,'latest_licenses':_0x29c070,'latest_logs':_0x544a63});},'updatedChartData':async(_0x44daee,_0x52e62c)=>{const _0x301086=a6_0x346cc9,{range:_0x11e246}=_0x44daee['query'];if(_0x11e246==='today')try{const _0x1c0855=await Requests[_0x301086(0x193)]({'date':new Date()[_0x301086(0x181)]()});if(_0x1c0855&&_0x1c0855[_0x301086(0x109)]){const _0x4dc275=_0x1c0855[_0x301086(0x109)],_0x237e9a=[];for(let _0x8c624a=0x0;_0x8c624a<0x18;_0x8c624a++){const _0x1c0ab0=new Date(new Date()[_0x301086(0x15a)](_0x8c624a+0x3,0x0,0x0,0x0));_0x237e9a[_0x301086(0x128)](_0x1c0ab0);}const _0x58e40d=new Array(0x18)['fill'](0x0),_0x3068a8=new Array(0x18)[_0x301086(0x178)](0x0);for(let _0x1c11ea=0x0;_0x1c11ea<_0x4dc275[_0x301086(0xce)];_0x1c11ea++){const _0x3e7afa=_0x4dc275[_0x1c11ea];if(_0x3e7afa['rejected']){const _0x3a85fb=_0x3e7afa[_0x301086(0x185)][_0x301086(0x163)]();_0x3068a8[_0x3a85fb]+=0x1;}else{const _0x5ce5d5=_0x3e7afa[_0x301086(0x185)][_0x301086(0x163)]();_0x58e40d[_0x5ce5d5]+=0x1;}}_0x52e62c[_0x301086(0x182)]({'successful':_0x58e40d,'rejected':_0x3068a8,'days':_0x237e9a});}else{const _0x3a9893=[];for(let _0xf7cfbb=0x0;_0xf7cfbb<0x18;_0xf7cfbb++){const _0x3cc4da=new Date(new Date()['setHours'](_0xf7cfbb+0x3,0x0,0x0,0x0));_0x3a9893['push'](_0x3cc4da);}_0x52e62c['json']({'successful':new Array(0x18)[_0x301086(0x178)](0x0),'rejected':new Array(0x18)[_0x301086(0x178)](0x0),'days':_0x3a9893});}}catch(_0x4f0f3d){console['log'](_0x4f0f3d);}if(_0x11e246===_0x301086(0x13f)){const _0x21c2f6=await LastNDates(0x7),_0x16c55f=await LastNDays(0x7),_0x240b38=await Requests[_0x301086(0xdc)]({'date':_0x21c2f6});let _0x18dd77,_0x3a0595;if(_0x240b38){_0x18dd77=[],_0x3a0595=[];for(let _0x39c1bf=0x0;_0x39c1bf<_0x21c2f6[_0x301086(0xce)];_0x39c1bf++){const _0x5484b2=_0x21c2f6[_0x39c1bf];let _0x405b57=0x0,_0x239d01=0x0;for(let _0x144753=0x0;_0x144753<_0x240b38[_0x301086(0xce)];_0x144753++){const _0x25f030=_0x240b38[_0x144753];if(_0x25f030[_0x301086(0x185)]!=null){if(_0x25f030[_0x301086(0x185)]===_0x5484b2){_0x239d01=_0x25f030['rejected_requests']==null?0x0:_0x25f030[_0x301086(0x11e)],_0x405b57=_0x25f030[_0x301086(0x101)]==null?0x0:_0x25f030[_0x301086(0x101)];break;}}}_0x18dd77[_0x301086(0x128)](_0x405b57),_0x3a0595[_0x301086(0x128)](_0x239d01);}}else _0x18dd77=[0x0,0x0,0x0,0x0,0x0,0x0,0x0],_0x3a0595=[0x0,0x0,0x0,0x0,0x0,0x0,0x0];_0x52e62c[_0x301086(0x182)]({'successful':_0x18dd77,'rejected':_0x3a0595,'days':_0x16c55f});}if(_0x11e246===_0x301086(0xd3))try{const _0x2a371f=await LastNDates(0x1e),_0x14d59f=await LastNDays(0x1e),_0x20c9c0=await Requests[_0x301086(0xdc)]({'date':_0x2a371f});let _0x6a7d00,_0x5f10e7;if(_0x20c9c0){_0x6a7d00=[],_0x5f10e7=[];for(let _0x32e9b3=0x0;_0x32e9b3<_0x2a371f[_0x301086(0xce)];_0x32e9b3++){const _0x1e32bd=_0x2a371f[_0x32e9b3];let _0x2b849c=0x0,_0x4d3354=0x0;for(let _0x2f8d0c=0x0;_0x2f8d0c<_0x20c9c0['length'];_0x2f8d0c++){const _0x1d349c=_0x20c9c0[_0x2f8d0c];if(_0x1d349c[_0x301086(0x185)]!=null){if(_0x1d349c[_0x301086(0x185)]===_0x1e32bd){_0x4d3354=_0x1d349c['rejected_requests']==null?0x0:_0x1d349c[_0x301086(0x11e)],_0x2b849c=_0x1d349c['successful_requests']==null?0x0:_0x1d349c[_0x301086(0x101)];break;}}}_0x6a7d00['push'](_0x2b849c),_0x5f10e7[_0x301086(0x128)](_0x4d3354);}}else _0x6a7d00=new Array(0x1e)['fill'](0x0),_0x5f10e7=new Array(0x1e)[_0x301086(0x178)](0x0);_0x52e62c[_0x301086(0x182)]({'successful':_0x6a7d00,'rejected':_0x5f10e7,'days':_0x14d59f});}catch(_0x44eeca){console['log'](_0x44eeca);}},'getLogsData':async(_0x4dfad6,_0x4c2b20)=>{const _0x270971=a6_0x346cc9;try{const _0x28bb48=parseInt(_0x4dfad6['query'][_0x270971(0x15c)]),_0x1eb4df=parseInt(_0x4dfad6['query'][_0x270971(0x17f)]),{query:_0x13f7ff}=_0x4dfad6[_0x270971(0x139)],{dashboard:_0x414ffa}=_0x4dfad6[_0x270971(0x139)],{requests:_0x182c6d}=_0x4dfad6[_0x270971(0x139)],{discord:_0x402f9c}=_0x4dfad6['query'],_0x448ebc=(_0x28bb48-0x1)*_0x1eb4df,_0x596911=_0x28bb48*_0x1eb4df,_0x1ee3e8={};let _0x22ca0a=[];if(_0x414ffa===_0x270971(0x12b)&&_0x182c6d===_0x270971(0x12b)&&_0x402f9c===_0x270971(0x12b))_0x22ca0a=await Logs[_0x270971(0xdc)]()[_0x270971(0x192)]({'_id':-0x1});else _0x414ffa===_0x270971(0x149)&&_0x182c6d===_0x270971(0x149)&&_0x402f9c===_0x270971(0x149)?_0x22ca0a=[]:(_0x402f9c===_0x270971(0x12b)&&_0x22ca0a[_0x270971(0x128)](...await Logs[_0x270971(0xdc)]({'status':0x2})),_0x182c6d==='true'&&_0x22ca0a[_0x270971(0x128)](...await Logs[_0x270971(0xdc)]({'status':0x1})),_0x414ffa==='true'&&_0x22ca0a['push'](...await Logs[_0x270971(0xdc)]({'status':0x0})),_0x22ca0a[_0x270971(0x192)]((_0x18321a,_0x423aa1)=>_0x423aa1[_0x270971(0xa7)]-_0x18321a[_0x270971(0xa7)]));const _0x38eb7c=[];if(_0x13f7ff&&_0x13f7ff!=='')for(let _0x29512f=0x0;_0x29512f<_0x22ca0a['length'];_0x29512f++){const _0x4893ed=_0x22ca0a[_0x29512f];(_0x4893ed[_0x270971(0x16e)]&&_0x4893ed[_0x270971(0x16e)][_0x270971(0xad)]()[_0x270971(0x168)](_0x13f7ff[_0x270971(0xad)]())||_0x4893ed['user']&&_0x4893ed[_0x270971(0xe6)][_0x270971(0xad)]()[_0x270971(0x168)](_0x13f7ff['toLowerCase']()))&&_0x38eb7c[_0x270971(0x128)](_0x4893ed);}let _0x3123f2;return _0x13f7ff&&_0x13f7ff!==''?_0x3123f2=_0x38eb7c:_0x3123f2=_0x22ca0a,_0x596911<_0x3123f2[_0x270971(0xce)]&&(_0x1ee3e8[_0x270971(0x14c)]={'page':_0x28bb48+0x1,'limit':_0x1eb4df}),_0x448ebc>0x0&&(_0x1ee3e8[_0x270971(0x114)]={'page':_0x28bb48-0x1,'limit':_0x1eb4df}),_0x1ee3e8['results']=_0x3123f2['slice'](_0x448ebc,_0x596911),_0x4c2b20[_0x270971(0x182)]({'logs':_0x1ee3e8,'total':_0x22ca0a['length']});}catch(_0x829d97){console[_0x270971(0xc3)](_0x829d97);}},'updateSavePreference':async(_0x3b39fa,_0x584bbf)=>{const _0x20a350=a6_0x346cc9,{dashboard:_0x30a169,requests:_0x119afc,discord:_0x42a115}=_0x3b39fa[_0x20a350(0xc2)],_0x3aca5f=await Users[_0x20a350(0x193)]({'_id':_0x3b39fa[_0x20a350(0xe6)]['id']});if(!_0x3aca5f||_0x3aca5f[_0x20a350(0x146)]!==0x0)return _0x584bbf[_0x20a350(0xde)](0x1f4)[_0x20a350(0x182)]({'msg':_0x20a350(0xbb)});const _0x3975f2=await Dashboard[_0x20a350(0xdc)]({});_0x3975f2[0x0]['save_dashboard']!==_0x30a169&&await Dashboard[_0x20a350(0x119)]({},{'$set':{'save_dashboard':_0x30a169}}),_0x3975f2[0x0][_0x20a350(0x132)]!==_0x119afc&&await Dashboard[_0x20a350(0x119)]({},{'$set':{'save_requests':_0x119afc}}),_0x3975f2[0x0][_0x20a350(0xd2)]!==_0x42a115&&await Dashboard[_0x20a350(0x119)]({},{'$set':{'save_discord':_0x42a115}}),_0x584bbf[_0x20a350(0x182)]({'msg':'Successfully\x20changed\x20saving\x20preferences'});},'getSwitchState':async(_0x4ae364,_0x33f295)=>{const _0x555a3b=a6_0x346cc9;try{const _0x293e9f=await Dashboard[_0x555a3b(0xdc)]({});_0x33f295['json']({'dashboard':_0x293e9f[0x0]['save_dashboard'],'requests':_0x293e9f[0x0]['save_requests'],'discord':_0x293e9f[0x0][_0x555a3b(0xd2)]});}catch(_0xdd87bb){console[_0x555a3b(0xc3)](_0xdd87bb);}},'getBlacklistData':async(_0x58e59d,_0x12017e)=>{const _0x1af6bd=a6_0x346cc9;try{const _0x2acca7=parseInt(_0x58e59d['query'][_0x1af6bd(0x15c)]),_0x1c6ac3=parseInt(_0x58e59d[_0x1af6bd(0x139)][_0x1af6bd(0x17f)]),_0x3e2674=(_0x2acca7-0x1)*_0x1c6ac3,_0x5bc1ef=_0x2acca7*_0x1c6ac3,_0x32f81c={},_0x152c5f=await Blacklist[_0x1af6bd(0xdc)]()[_0x1af6bd(0x192)]({'_id':-0x1});return _0x5bc1ef<_0x152c5f[_0x1af6bd(0xce)]&&(_0x32f81c[_0x1af6bd(0x14c)]={'page':_0x2acca7+0x1,'limit':_0x1c6ac3}),_0x3e2674>0x0&&(_0x32f81c[_0x1af6bd(0x114)]={'page':_0x2acca7-0x1,'limit':_0x1c6ac3}),_0x32f81c[_0x1af6bd(0xb8)]=_0x152c5f['slice'](_0x3e2674,_0x5bc1ef),_0x12017e['json']({'total':_0x152c5f[_0x1af6bd(0xce)],'blacklist':_0x32f81c});}catch(_0xff416f){console[_0x1af6bd(0xc3)](_0xff416f);}},'addBlacklistData':async(_0x2884f1,_0x47a1f0)=>{const _0x2c81eb=a6_0x346cc9,{blacklisted:_0x1e6dcc,type:_0x4f608a,created_by:_0x471a3d}=_0x2884f1[_0x2c81eb(0xc2)],_0x152175=await Users[_0x2c81eb(0x137)]({'_id':_0x2884f1[_0x2c81eb(0xe6)]['id']});try{const _0x2f003b=await Blacklist[_0x2c81eb(0x193)]({'blacklisted':_0x1e6dcc});if(_0x2f003b)return _0x47a1f0[_0x2c81eb(0xde)](0x190)['json']({'msg':_0x2c81eb(0x124)});let _0x22afb5;if(_0x4f608a==='ip'){const _0x466b39=/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/;if(!_0x466b39[_0x2c81eb(0x161)](_0x1e6dcc))return _0x47a1f0[_0x2c81eb(0xde)](0x190)[_0x2c81eb(0x182)]({'msg':_0x2c81eb(0xe1)});_0x22afb5=await axios['get'](_0x2c81eb(0x188)+_0x1e6dcc+'?vpn=1&asn=1')['then'](_0x4e63e4=>_0x4e63e4['data'][_0x1e6dcc][_0x2c81eb(0x10e)]+'\x20/\x20'+_0x4e63e4['data'][_0x1e6dcc][_0x2c81eb(0xda)])[_0x2c81eb(0x13d)](_0x1c4b02=>console[_0x2c81eb(0xc3)](_0x1c4b02));}if(_0x4f608a===_0x2c81eb(0x100)){if(_0x1e6dcc[_0x2c81eb(0xce)]<0x14)return _0x47a1f0[_0x2c81eb(0xde)](0x190)[_0x2c81eb(0x182)]({'msg':'Invalid\x20HWID'});}const _0x55a31c=new Blacklist({'blacklisted':_0x1e6dcc,'type':_0x4f608a,'blocked_connections':0x0,'region':_0x22afb5,'created_by':_0x471a3d});await _0x55a31c['save'](),_0x47a1f0[_0x2c81eb(0x182)]({'msg':_0x2c81eb(0x186)}),logger(_0x2c81eb(0x16b),_0x152175[_0x2c81eb(0xec)],0x0);}catch(_0x5b9cd5){console['log'](_0x5b9cd5);}},'deleteBlacklist':async(_0x1e87c2,_0x54de58)=>{const _0x55fb77=a6_0x346cc9,_0x46fd22=_0x1e87c2[_0x55fb77(0xc2)]['blacklisted'];if(!_0x46fd22)return _0x54de58[_0x55fb77(0xde)](0x190);try{await Blacklist[_0x55fb77(0x174)]({'_id':_0x46fd22}),_0x54de58[_0x55fb77(0x182)]({'msg':_0x55fb77(0x112)});const _0x576cf2=await Users[_0x55fb77(0x137)]({'_id':_0x1e87c2['user']['id']});logger('Blacklist\x20removed',_0x576cf2['name'],0x0);}catch(_0x8b789c){console[_0x55fb77(0xc3)](_0x8b789c);}},'updateProgressGoal':async(_0x416f02,_0x1527e3)=>{const _0x3efc23=a6_0x346cc9,_0x1897ad=_0x416f02[_0x3efc23(0xc2)][_0x3efc23(0xc5)];if(!_0x1897ad)return;const _0x59d504=await Users[_0x3efc23(0x193)]({'_id':_0x416f02[_0x3efc23(0xe6)]['id']});if(!_0x59d504||_0x59d504[_0x3efc23(0x146)]!==0x0)return _0x1527e3['status'](0x1f4)[_0x3efc23(0x182)]({'msg':_0x3efc23(0xbb)});const _0x2a8761=parseInt(_0x1897ad);if(_0x2a8761<0x1)return _0x1527e3[_0x3efc23(0xde)](0x190)[_0x3efc23(0x182)]({'msg':_0x3efc23(0xaa)});await Dashboard[_0x3efc23(0x119)]({},{'$set':{'license_goal_monthly':_0x2a8761}}),_0x1527e3[_0x3efc23(0x182)]({'msg':_0x3efc23(0x17b)}),logger(_0x3efc23(0x133),_0x59d504[_0x3efc23(0xec)],0x0);},'updateDiscordBot':async(_0x5d77b5,_0x3f7425)=>{const _0x225402=a6_0x346cc9,{bot_label:_0x4a32f5,bot_color:_0x256f50,bot_activity:_0x2ba058,bot_success:_0x302ba5,bot_failed:_0x15de18,bot_timeout:_0xab2f8a,self_verify:_0x1db24a,customer_role:_0x328fbb}=_0x5d77b5[_0x225402(0xc2)],_0x20d5af=await Users[_0x225402(0x193)]({'_id':_0x5d77b5[_0x225402(0xe6)]['id']});if(!_0x20d5af||_0x20d5af[_0x225402(0x146)]!==0x0)return _0x3f7425[_0x225402(0xde)](0x1f4)[_0x225402(0x182)]({'msg':'Permission\x20denied'});if(_0x4a32f5[_0x225402(0xce)]>0x19)return _0x3f7425[_0x225402(0xde)](0x190)[_0x225402(0x182)]({'msg':'Invalid\x20bot\x20label'});if(_0x2ba058[_0x225402(0xce)]>0x78)return _0x3f7425[_0x225402(0xde)](0x190)['json']({'msg':'Invalid\x20bot\x20activity'});const _0x2bca37=/^#[0-9a-f]{3,6}$/i;if(!_0x2bca37[_0x225402(0x161)](_0x256f50)||!_0x2bca37['test'](_0x15de18)||!_0x2bca37[_0x225402(0x161)](_0xab2f8a)||!_0x2bca37[_0x225402(0x161)](_0x302ba5))return _0x3f7425['status'](0x190)[_0x225402(0x182)]({'msg':'Invalid\x20bot\x20embed\x20colors'});if(_0x328fbb&&_0x328fbb!==''&&_0x1db24a!==_0x225402(0x149)){if(isNaN(_0x328fbb)||_0x328fbb[_0x225402(0xce)]<0x11)return _0x3f7425[_0x225402(0xde)](0x190)['json']({'msg':'Invalid\x20customer\x20role\x20ID'});}try{await Dashboard[_0x225402(0x119)]({},{'$set':{'discord_bot_label':_0x4a32f5,'discord_bot_color':_0x256f50,'discord_bot_failed':_0x15de18,'discord_bot_timeout':_0xab2f8a,'discord_bot_success':_0x302ba5,'self_verify':_0x1db24a,'customer_role':_0x328fbb,'discord_bot_activity':_0x2ba058}}),_0x3f7425['json']({'msg':'Successfully\x20updated\x20Discord\x20bot\x20data'});const _0x3029d1=new Client({'intents':[Intents['FLAGS'][_0x225402(0xb3)]]});await _0x3029d1[_0x225402(0x159)](process[_0x225402(0x138)][_0x225402(0xbd)]),_0x3029d1[_0x225402(0xe6)][_0x225402(0x195)](_0x2ba058,{'type':'PLAYING'});}catch(_0x3fb25a){console[_0x225402(0xc3)](_0x3fb25a);}},'updateDiscordWebhook':async(_0x3dda51,_0x17fc9d)=>{const _0x4fd0c3=a6_0x346cc9,{webhook_error:_0x57b71b,webhook_success:_0x56841a,webhook_warning:_0x339c5f,webhook_label:_0x357ff1,webhook_url:_0xb379fd}=_0x3dda51[_0x4fd0c3(0xc2)],_0x664366=await Users[_0x4fd0c3(0x193)]({'_id':_0x3dda51[_0x4fd0c3(0xe6)]['id']});if(!_0x664366||_0x664366[_0x4fd0c3(0x146)]!==0x0)return _0x17fc9d[_0x4fd0c3(0xde)](0x1f4)[_0x4fd0c3(0x182)]({'msg':_0x4fd0c3(0xbb)});if(!_0x357ff1||_0x357ff1[_0x4fd0c3(0xce)]>0x19)return _0x17fc9d[_0x4fd0c3(0xde)](0x190)['json']({'msg':'Invalid\x20webhook\x20label'});const _0x35c9a3=/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi;if(!_0x35c9a3[_0x4fd0c3(0x161)](_0xb379fd))return _0x17fc9d[_0x4fd0c3(0xde)](0x190)['json']({'msg':'Invalid\x20webhook\x20URL'});const _0xe5e76f=/^#[0-9a-f]{3,6}$/i;if(!_0xe5e76f['test'](_0x57b71b)||!_0xe5e76f[_0x4fd0c3(0x161)](_0x56841a)||!_0xe5e76f[_0x4fd0c3(0x161)](_0x339c5f))return _0x17fc9d[_0x4fd0c3(0xde)](0x190)[_0x4fd0c3(0x182)]({'msg':_0x4fd0c3(0xb5)});await Dashboard[_0x4fd0c3(0x119)]({},{'$set':{'webhook_success_color':_0x56841a,'webhook_error_color':_0x57b71b,'webhook_warning_color':_0x339c5f,'webhook_url':_0xb379fd,'webhook_label':_0x357ff1}}),_0x17fc9d[_0x4fd0c3(0x182)]({'msg':_0x4fd0c3(0xc7)});},'updateDiscordWebhookImg':async(_0x595325,_0x4a255d)=>{upload(_0x595325,_0x4a255d,async _0x1affcb=>{const _0x228872=a6_0x5d1e;if(_0x1affcb)return console[_0x228872(0xc3)](_0x1affcb),_0x4a255d[_0x228872(0xde)](0x1f4)[_0x228872(0x182)]({'msg':_0x1affcb[_0x228872(0xae)]});const _0x1c33b9=_0x595325['file'][_0x228872(0xba)],_0x6d900b=await sharp(_0x1c33b9)[_0x228872(0x127)](0xc8,0xc8)[_0x228872(0xe4)]();await sharp(_0x6d900b)[_0x228872(0xdb)](_0x1c33b9);const _0x45ed8b=await Dashboard[_0x228872(0x193)](),_0x3d5f8e=path[_0x228872(0xf1)](__dirname,_0x228872(0xee)+_0x45ed8b['webhook_image']);return fs[_0x228872(0xed)](_0x3d5f8e)&&fs[_0x228872(0x18d)](_0x3d5f8e),logger(_0x228872(0x123),null,0x0),await Dashboard[_0x228872(0x119)]({},{'$set':{'webhook_image':_0x595325[_0x228872(0x12d)][_0x228872(0xff)]}}),_0x4a255d['json']({'msg':_0x228872(0x116)});});},'getSettingsData':async(_0x11292a,_0x4f2aef)=>{const _0x3dfe89=a6_0x346cc9;try{const _0x45cf7a=await Dashboard[_0x3dfe89(0x193)]();_0x45cf7a[_0x3dfe89(0x14d)]=await decrypt(_0x45cf7a[_0x3dfe89(0x14d)]),_0x45cf7a[_0x3dfe89(0xc8)]=await decrypt(_0x45cf7a[_0x3dfe89(0xc8)]),_0x4f2aef[_0x3dfe89(0x182)](_0x45cf7a);}catch(_0x3f298c){console['log'](_0x3f298c);}},'resetWebhookImage':async(_0x482714,_0x4464fb)=>{const _0x33f070=a6_0x346cc9;try{const _0x430753=await Dashboard[_0x33f070(0x193)]();if(!_0x430753[_0x33f070(0x122)]||_0x430753[_0x33f070(0x122)]==='https://i.imgur.com/A3OVRtG.png')return _0x4464fb[_0x33f070(0xde)](0x190)[_0x33f070(0x182)]({'msg':_0x33f070(0x162)});await Dashboard[_0x33f070(0x119)]({},{'$set':{'webhook_image':_0x33f070(0x198)}}),_0x4464fb[_0x33f070(0x182)]({'msg':'Successfully\x20reset\x20webhook\x20image'});}catch(_0x47a810){return console['log'](_0x47a810);}},'resetApiKey':async(_0x4360c9,_0x577be9)=>{const _0x121e05=a6_0x346cc9,{type:_0x37fc38,password:_0x21d619}=_0x4360c9[_0x121e05(0xc2)];if(!_0x21d619)return _0x577be9[_0x121e05(0xde)](0x190)[_0x121e05(0x182)]({'msg':_0x121e05(0xe2)});if(!_0x37fc38||_0x37fc38!==_0x121e05(0x14d)&&_0x37fc38!==_0x121e05(0xc8))return _0x577be9['status'](0x1f4)[_0x121e05(0x182)]({'msg':_0x121e05(0x117)});const _0x5add7d=await Users[_0x121e05(0x193)]({'_id':_0x4360c9['user']['id']});if(!_0x5add7d||_0x5add7d[_0x121e05(0x146)]!==0x0)return _0x577be9['status'](0x1f4)[_0x121e05(0x182)]({'msg':_0x121e05(0xbb)});const _0x21499e=await argon[_0x121e05(0x169)](_0x5add7d[_0x121e05(0xb4)],_0x21d619);if(!_0x21499e)return _0x577be9['status'](0x190)[_0x121e05(0x182)]({'msg':_0x121e05(0xd8)});const _0x1b0ccb=crypto['randomBytes'](0x28)['toString'](_0x121e05(0x189))[_0x121e05(0xb0)](0x0,0x28),_0x7797cf=await encrypt(_0x1b0ccb);if(_0x37fc38===_0x121e05(0xc8))try{return await Dashboard[_0x121e05(0x119)]({},{'$set':{'public_key':_0x7797cf}}),logger(_0x121e05(0x164),_0x5add7d[_0x121e05(0xec)],0x0),_0x577be9[_0x121e05(0x182)]({'msg':'Successfully\x20reset\x20public\x20API\x20key','key':_0x1b0ccb});}catch(_0x191d3c){console[_0x121e05(0xc3)](_0x191d3c);}if(_0x37fc38===_0x121e05(0x14d))try{return await Dashboard['findOneAndUpdate']({},{'$set':{'private_key':_0x7797cf}}),logger('Private\x20key\x20reset',_0x5add7d[_0x121e05(0xec)],0x0),_0x577be9[_0x121e05(0x182)]({'msg':_0x121e05(0x113),'key':_0x1b0ccb});}catch(_0x18d69a){console['log'](_0x18d69a);}}},createAccessToken=_0x16374c=>jwt['sign'](_0x16374c,process[a6_0x346cc9(0x138)][a6_0x346cc9(0xf3)],{'expiresIn':'5m'}),createRefreshToken=_0x49b273=>jwt[a6_0x346cc9(0xbc)](_0x49b273,process[a6_0x346cc9(0x138)][a6_0x346cc9(0x14f)],{'expiresIn':'6h'});module[a6_0x346cc9(0xdf)]=userCtrl;