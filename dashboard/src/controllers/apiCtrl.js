const a4_0x7d1c=['ip_geo_lock','product_name','hwid_list','EXPIRED_LICENSEKEY','21whBmSa','socket','MAXIMUM_HWIDS','../utils/apiCtrl/rejectionHandler','toString','INVALID_LICENSEKEY','unknown','_id','../utils/dateago','expires_date','../utils/apiCtrl/countrylockHandler','licensekey','../utils/apiCtrl/blacklistHandler','expires_times','Blacklisted\x20IP/HWID','description','../utils/apiCtrl/webhookHandler','clientname','failed','Invalid\x20product','discord_username','Maximum\x20IPs','authorization','470581CdzgKt','substr','12900ATvaDU','BLOCKED_COUNTRY','headers','findOne','substring','85724MsFntU','14ChOyrz','MAXIMUM_IPS','hwid','../models/licenseModel','success','expires_type','cf-connecting-ip','warning','465907OgrOgl','BLACKLISTED','hwid_cap','FAILED_AUTHENTICATION','Maximum\x20HWIDs','name','160620TdPoKh','ip_list','exports','find','version','findByIdAndUpdate','Invalid\x20licensekey','../utils/apiCtrl/ipObject','694201337','slice','json','ip_cap','897263wjDHeq','INVALID_PRODUCT','never','body','50727JmaOgx','discord_id','remoteAddress','../utils/apiCtrl/hwidObject','expires','Expired\x20licensekey','../utils/apiCtrl/expiringHandler','length','error','Successful\x20authentication','../utils/crypto','../utils/apiCtrl/hwidHandler','now'];const a4_0xd8323b=a4_0x1d01;(function(_0x399433,_0x1fb4b2){const _0x2229da=a4_0x1d01;while(!![]){try{const _0x1e053b=-parseInt(_0x2229da(0x1ca))+-parseInt(_0x2229da(0x18c))+-parseInt(_0x2229da(0x19e))+parseInt(_0x2229da(0x1d1))*parseInt(_0x2229da(0x1d2))+parseInt(_0x2229da(0x1b3))*parseInt(_0x2229da(0x1a2))+parseInt(_0x2229da(0x192))+parseInt(_0x2229da(0x1cc));if(_0x1e053b===_0x1fb4b2)break;else _0x399433['push'](_0x399433['shift']());}catch(_0x23a071){_0x399433['push'](_0x399433['shift']());}}}(a4_0x7d1c,0x93bf4));function a4_0x1d01(_0xe2b156,_0x21ff0e){return a4_0x1d01=function(_0x7d1c1b,_0x1d01f7){_0x7d1c1b=_0x7d1c1b-0x185;let _0x219ce7=a4_0x7d1c[_0x7d1c1b];return _0x219ce7;},a4_0x1d01(_0xe2b156,_0x21ff0e);}const {rejectionHandler}=require(a4_0xd8323b(0x1b6)),Licenses=require(a4_0xd8323b(0x187)),Products=require('../models/productsModel'),{decrypt}=require(a4_0xd8323b(0x1ac)),{expiringHandler}=require(a4_0xd8323b(0x1a8)),{ipHandler}=require('../utils/apiCtrl/ipHandler'),{hwidHandler}=require(a4_0xd8323b(0x1ad)),{ipObject}=require(a4_0xd8323b(0x199)),{hwidObject}=require(a4_0xd8323b(0x1a5)),{logger}=require('../utils/logger'),{webhookHandler}=require(a4_0xd8323b(0x1c3)),{blacklistHandler}=require(a4_0xd8323b(0x1bf)),{countrylockHandler}=require(a4_0xd8323b(0x1bd)),{dateAgo}=require(a4_0xd8323b(0x1bb)),apiCtrl={'verify':async(_0x4da099,_0x2de72b)=>{const _0x204fcc=a4_0xd8323b,{product:_0x336aa5,licensekey:_0x168a06,hwid:_0x30ce56,version:_0x44438e}=_0x4da099[_0x204fcc(0x1a1)];let _0x22f7e3=_0x4da099[_0x204fcc(0x1ce)][_0x204fcc(0x18a)]||_0x4da099[_0x204fcc(0x1ce)]['x-real-ip']||_0x4da099[_0x204fcc(0x1ce)]['x-forwarded-for']||_0x4da099[_0x204fcc(0x1b4)][_0x204fcc(0x1a4)];_0x22f7e3[_0x204fcc(0x1cb)](0x0,0x7)==='::ffff:'&&(_0x22f7e3=_0x22f7e3['substr'](0x7));if(!_0x336aa5||!_0x168a06)return rejectionHandler(!![],_0x22f7e3),webhookHandler('Invalid\x20licensekey',_0x22f7e3,null,null,null,_0x204fcc(0x1aa)),_0x2de72b[_0x204fcc(0x19c)]({'status_msg':_0x204fcc(0x18f),'status_overview':'failed','status_code':0x190});const _0x512d36=await Licenses[_0x204fcc(0x195)]();let _0x512e2c;for(let _0x30818e=0x0;_0x30818e<_0x512d36['length'];_0x30818e++){const _0x4f8217=_0x512d36[_0x30818e],_0x501022=decrypt(_0x4f8217[_0x204fcc(0x1be)]);if(_0x501022===_0x168a06){_0x512e2c=_0x4f8217;break;}}const _0x5e6f13=await blacklistHandler(_0x22f7e3,_0x30ce56);if(_0x5e6f13)return rejectionHandler(!![],_0x22f7e3,_0x512e2c),logger('Blacklisted\x20IP/HWID',null,0x1,_0x22f7e3),webhookHandler(_0x204fcc(0x1c1),_0x22f7e3,_0x512e2c||null,_0x30ce56,_0x44438e===undefined?null:_0x44438e,_0x204fcc(0x1aa),_0x336aa5,null,_0x168a06),_0x2de72b['json']({'status_msg':_0x204fcc(0x18d),'status_overview':_0x204fcc(0x1c5),'status_code':0x193});if(!_0x512e2c)return rejectionHandler(!![],_0x22f7e3),logger(_0x204fcc(0x198),null,0x1,_0x22f7e3),webhookHandler(_0x204fcc(0x198),_0x22f7e3,null,_0x30ce56,_0x44438e,_0x204fcc(0x1aa),_0x336aa5,null,_0x168a06),_0x2de72b['json']({'status_msg':_0x204fcc(0x1b8),'status_overview':'failed','status_code':0x191});const _0x3d1e16=await expiringHandler(_0x512e2c);if(_0x3d1e16){rejectionHandler(!![],_0x22f7e3,_0x512e2c),_0x2de72b[_0x204fcc(0x19c)]({'status_msg':_0x204fcc(0x1b2),'status_overview':_0x204fcc(0x1c5),'status_code':0x19a});if(_0x512e2c['expires_delete_after']===!![])return await Licenses['findByIdAndDelete']({'_id':_0x512e2c[_0x204fcc(0x1ba)]}),webhookHandler('Deleted\x20expired\x20licensekey',_0x22f7e3,_0x512e2c,_0x30ce56,_0x44438e,_0x204fcc(0x18b),_0x336aa5),logger('Expired\x20licensekey',_0x512e2c[_0x204fcc(0x1c4)],0x1,_0x22f7e3);return webhookHandler(_0x204fcc(0x1a7),_0x22f7e3,_0x512e2c,_0x30ce56,_0x44438e,'warning',_0x336aa5),logger(_0x204fcc(0x1a7),_0x512e2c[_0x204fcc(0x1c4)],0x1,_0x22f7e3);}const _0x54e02d=await Products[_0x204fcc(0x1cf)]({'name':_0x336aa5});if(!_0x54e02d)return rejectionHandler(!![],_0x22f7e3,_0x512e2c),logger(_0x204fcc(0x1c6),_0x512e2c['clientname'],0x1,_0x22f7e3),webhookHandler(_0x204fcc(0x1c6),_0x22f7e3,_0x512e2c,_0x30ce56,_0x44438e,'warning',_0x336aa5),_0x2de72b[_0x204fcc(0x19c)]({'status_msg':_0x204fcc(0x19f),'status_overview':_0x204fcc(0x1c5),'status_code':0x191});if(_0x54e02d[_0x204fcc(0x191)]!==_0x512e2c[_0x204fcc(0x1b0)])return rejectionHandler(!![],_0x22f7e3,_0x512e2c),logger('Invalid\x20product',_0x512e2c['clientname'],0x1,_0x22f7e3),webhookHandler(_0x204fcc(0x1c6),_0x22f7e3,_0x512e2c,_0x30ce56,_0x44438e,'warning',_0x336aa5),_0x2de72b[_0x204fcc(0x19c)]({'status_msg':_0x204fcc(0x19f),'status_overview':_0x204fcc(0x1c5),'status_code':0x191});await ipHandler(_0x512e2c);if(_0x512e2c['ip_cap']&&_0x512e2c['ip_list'][_0x204fcc(0x1a9)]>=_0x512e2c[_0x204fcc(0x19d)]){let _0x4c87ef=![];for(let _0x5bd423=0x0;_0x5bd423<_0x512e2c[_0x204fcc(0x193)][_0x204fcc(0x1a9)];_0x5bd423++){const _0x133a7d=_0x512e2c[_0x204fcc(0x193)][_0x5bd423];_0x133a7d['ip']!==_0x22f7e3&&(_0x4c87ef=!![]);}if(_0x4c87ef)return rejectionHandler(!![],_0x22f7e3,_0x512e2c),logger(_0x204fcc(0x1c8),_0x512e2c[_0x204fcc(0x1c4)],0x1,_0x22f7e3),webhookHandler(_0x204fcc(0x1c8),_0x22f7e3,_0x512e2c,_0x30ce56,_0x44438e,'warning',_0x336aa5),_0x2de72b[_0x204fcc(0x19c)]({'status_msg':_0x204fcc(0x185),'status_overview':_0x204fcc(0x1c5),'status_code':0x191});}await hwidHandler(_0x512e2c);if(_0x512e2c[_0x204fcc(0x18e)]&&_0x512e2c[_0x204fcc(0x1b1)][_0x204fcc(0x1a9)]>=_0x512e2c[_0x204fcc(0x18e)]){let _0x2fb884=![];for(let _0x2fe0d5=0x0;_0x2fe0d5<_0x512e2c[_0x204fcc(0x1b1)][_0x204fcc(0x1a9)];_0x2fe0d5++){const _0x45445e=_0x512e2c[_0x204fcc(0x1b1)][_0x2fe0d5];_0x45445e[_0x204fcc(0x186)]!==_0x30ce56&&(_0x2fb884=!![]);}if(_0x2fb884)return rejectionHandler(!![],_0x22f7e3,_0x512e2c),logger(_0x204fcc(0x190),_0x512e2c[_0x204fcc(0x1c4)],0x1,_0x22f7e3),webhookHandler('Maximum\x20HWIDs',_0x22f7e3,_0x512e2c,_0x30ce56,_0x44438e,_0x204fcc(0x18b),_0x336aa5),_0x2de72b[_0x204fcc(0x19c)]({'status_msg':_0x204fcc(0x1b5),'status_overview':'failed','status_code':0x191});}if(_0x512e2c[_0x204fcc(0x1af)]){const [_0x4cbcdd,_0x5f154c]=await countrylockHandler(_0x512e2c[_0x204fcc(0x1af)],_0x22f7e3);if(_0x4cbcdd)return rejectionHandler(!![],_0x22f7e3,_0x512e2c),logger('Blocked\x20country',_0x512e2c[_0x204fcc(0x1c4)],0x1,_0x22f7e3),webhookHandler('Blocked\x20country',_0x22f7e3,_0x512e2c,_0x30ce56,_0x44438e,'warning',_0x336aa5,_0x5f154c),_0x2de72b[_0x204fcc(0x19c)]({'status_msg':_0x204fcc(0x1cd),'status_overview':_0x204fcc(0x1c5),'status_code':0x191});}await Licenses[_0x204fcc(0x197)]({'_id':_0x512e2c[_0x204fcc(0x1ba)]},{'$set':{'latest_request':new Date(),'latest_ip':_0x22f7e3,'latest_hwid':_0x30ce56},'$inc':{'total_requests':0x1}}),_0x512e2c=await Licenses[_0x204fcc(0x1cf)]({'_id':_0x512e2c[_0x204fcc(0x1ba)]}),rejectionHandler(![],_0x22f7e3,_0x512e2c),await ipObject(_0x22f7e3,_0x512e2c);_0x30ce56&&await hwidObject(_0x30ce56,_0x512e2c);const _0x3bf6d3=_0x4da099[_0x204fcc(0x1ce)][_0x204fcc(0x1c9)][_0x204fcc(0x1d0)](0x0,0x2),_0x563a6b=Date[_0x204fcc(0x1ae)]()[_0x204fcc(0x1b7)]()[_0x204fcc(0x19b)](0x0,-0x5),_0x55c6ca=_0x4da099[_0x204fcc(0x1a1)][_0x204fcc(0x1be)]['substring'](0x0,0x2),_0x1b2007=_0x4da099['body'][_0x204fcc(0x1be)]['substring'](_0x4da099[_0x204fcc(0x1a1)][_0x204fcc(0x1be)][_0x204fcc(0x1a9)]-0x2,_0x4da099[_0x204fcc(0x1a1)][_0x204fcc(0x1be)][_0x204fcc(0x1a9)]),_0x36b210=Buffer['from'](_0x55c6ca+_0x1b2007+_0x3bf6d3)[_0x204fcc(0x1b7)]('base64'),_0x1ba891=_0x36b210+_0x204fcc(0x19a)+_0x563a6b;let _0x3c7c7b;_0x512e2c[_0x204fcc(0x1a6)]?((_0x512e2c[_0x204fcc(0x189)]===0x1||_0x512e2c['expires_type']===0x2)&&(_0x3c7c7b=await dateAgo(_0x512e2c[_0x204fcc(0x1bc)])),_0x512e2c['expires_type']===0x3&&(_0x3c7c7b=_0x512e2c['total_requests']+'/'+_0x512e2c[_0x204fcc(0x1c0)])):_0x3c7c7b=_0x204fcc(0x1a0);_0x2de72b[_0x204fcc(0x19c)]({'status_msg':'SUCCESSFUL_AUTHENTICATION','status_overview':_0x204fcc(0x188),'status_code':0xc8,'status_id':_0x1ba891,'description':_0x512e2c[_0x204fcc(0x1c2)],'version':_0x54e02d[_0x204fcc(0x196)],'clientname':_0x512e2c[_0x204fcc(0x1c4)],'discord_username':_0x512e2c[_0x204fcc(0x1c7)]||_0x204fcc(0x1b9),'discord_id':_0x512e2c[_0x204fcc(0x1a3)]||_0x204fcc(0x1b9),'expires':_0x3c7c7b});const _0x45272a=await Licenses[_0x204fcc(0x1cf)]({'_id':_0x512e2c[_0x204fcc(0x1ba)]});return webhookHandler(_0x204fcc(0x1ab),_0x22f7e3,_0x45272a,_0x30ce56,_0x44438e,_0x204fcc(0x188),_0x336aa5),logger(_0x204fcc(0x1ab),_0x512e2c[_0x204fcc(0x1c4)],0x1,_0x22f7e3);}};module[a4_0xd8323b(0x194)]=apiCtrl;